<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="../assets/css/light.css" integrity="sha512-J8Ko83OT11zQ2/+vowqJ0Ovx2JEWUBNPTbNptixluYAHAO009R7GVxRQNKA+Wq4skbsdZr1AEOjF2AeQmKt3/A==" title="Light" id="stylesheet-light"><link rel="stylesheet" href="../assets/css/dark.css" integrity="sha512-kK/Wf2991I8CFsf5/Qu/2GIm2Enzw8H70RQ/yHNIb6iGTPF/SKE0B+kxTG2HjcFOgcjfKxZ9Jr4bvSfuKraNWw==" title="Dark" id="stylesheet-dark" disabled><title>Programming Language Foundations in Agda – BigStep</title><script src="../assets/js/anchor.js" integrity="sha512-Y5IMGqYQp36NYYdEL6gXISLsHNpx0LxW0NS0twvYBvXI8GH5PZa1g5gm1B5lxg6tlFyUAiOOfgKL/NIn0dtY4w==" id="script-anchor"></script><script src="../assets/js/darkmode.js" integrity="sha512-iUX9HnSphH4WbMv88MYJEFtLfkCtTHrvWyFwjigSm5GkwHv1L31GP5grIGDo7kI2jftuYVvt4xu4qeCn2fKbww==" id="script-darkmode"></script><script src="../assets/js/main.js" integrity="sha512-X7aZg6IUKq1TvTVjSureaMGKZ/ylbAD7kxiU2w42IUgh4lUTWoOsoIWzNvrqkwBJdQ1y2GsS67gtsv39Uuq6ew==" id="script-main"></script></head><body><header class="site-header" aria-label="Site"><div class="wrapper"><a class="site-title" href="../">Programming Language Foundations in Agda</a><nav class="site-nav" aria-label="Site"><input type="checkbox" id="nav-trigger" class="nav-trigger"><label for="nav-trigger"><span class="menu-icon"><svg class="svg-icon grey" viewBox="0 0 18 15" width="18px" height="15px"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path></svg></span></label><div class="trigger"><a class="page-link" href="../">The Book</a> <a class="page-link" href="../Announcements/">Announcements</a> <a class="page-link" href="../GettingStarted/">Getting Started</a> <a class="page-link" href="../Citing/">Citing</a> <a class="page-link" href="https://agda-zh.github.io/PLFA-zh/">中文</a> <a class="page-link" onclick="window.darkmode.toggle()"><i id="darkmode-trigger" class="fas fa-moon"></i> </a><a class="page-link" href="../plfa.epub"><i class="fa fa-book"></i></a></div></nav></div></header><main class="page-content" aria-label="Content"><div class="wrapper"><article class="post"><nav class="pager" aria-label="Chapter"><ul class="pagination"><li><a class="pagelink" href="../Confluence/">Prev</a></li><li class="separator">•</li><li><a class="pagelink" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/part2/BigStep.lagda.md">Source</a></li><li class="separator">•</li><li><a class="pagelink" href="../Denotational/">Next</a></li><li class="separator">•</li></ul></nav><header class="post-header" aria-label="Chapter"><h1 class="post-title">BigStep: Big-step semantics of untyped lambda calculus</h1></header><div class="post-content"><pre class="Agda"><a id="plfa_plfa-part2-BigStep-109" class="Keyword">module</a> <a id="plfa_plfa-part2-BigStep-116" href="../BigStep/#" class="Module">plfa.part2.BigStep</a> <a id="plfa_plfa-part2-BigStep-135" class="Keyword">where</a>
</pre><h2 id="introduction">Introduction</h2><p>The call-by-name evaluation strategy is a deterministic method for computing the value of a program in the lambda calculus. That is, call-by-name produces a value if and only if beta reduction can reduce the program to a lambda abstraction. In this chapter we define call-by-name evaluation and prove the forward direction of this if-and-only-if. The backward direction is traditionally proved via Curry-Feys standardisation, which is quite complex. We give a sketch of that proof, due to Plotkin, but postpone the proof in Agda until after we have developed a denotational semantics for the lambda calculus, at which point the proof is an easy corollary of properties of the denotational semantics.</p><p>We present the call-by-name strategy as a relation between an input term and an output value. Such a relation is often called a <em>big-step semantics</em>, written <code>M ⇓ V</code>, as it relates the input term <code>M</code> directly to the final result <code>V</code>, in contrast to the small-step reduction relation, <code>M —→ M′</code>, that maps <code>M</code> to another term <code>M′</code> in which a single sub-computation has been completed.</p><h2 id="imports">Imports</h2><pre class="Agda"><a id="plfa_plfa-part2-BigStep-1271" class="Keyword">open</a> <a id="plfa_plfa-part2-BigStep-1276" class="Keyword">import</a> <a id="plfa_plfa-part2-BigStep-1283" href="https://agda.github.io/agda-stdlib/v2.1/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
  <a id="plfa_plfa-part2-BigStep-1323" class="Keyword">using</a> <a id="plfa_plfa-part2-BigStep-1329" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1330" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="plfa_plfa-part2-BigStep-1333" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1335" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="plfa_plfa-part2-BigStep-1339" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1341" href="https://agda.github.io/agda-stdlib/v2.1/Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a><a id="plfa_plfa-part2-BigStep-1346" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1348" href="https://agda.github.io/agda-stdlib/v2.1/Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a><a id="plfa_plfa-part2-BigStep-1351" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1353" href="https://agda.github.io/agda-stdlib/v2.1/Relation.Binary.PropositionalEquality.Core.html#1670" class="Function">cong-app</a><a id="plfa_plfa-part2-BigStep-1361" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-1363" class="Keyword">open</a> <a id="plfa_plfa-part2-BigStep-1368" class="Keyword">import</a> <a id="plfa_plfa-part2-BigStep-1375" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="plfa_plfa-part2-BigStep-1393" class="Keyword">using</a> <a id="plfa_plfa-part2-BigStep-1399" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1400" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="plfa_plfa-part2-BigStep-1403" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1405" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="plfa_plfa-part2-BigStep-1406" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1408" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1244" class="Function">Σ-syntax</a><a id="plfa_plfa-part2-BigStep-1416" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1418" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#852" class="Function">∃</a><a id="plfa_plfa-part2-BigStep-1419" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1421" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1371" class="Function">∃-syntax</a><a id="plfa_plfa-part2-BigStep-1429" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1431" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#636" class="Field">proj₁</a><a id="plfa_plfa-part2-BigStep-1436" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1438" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#650" class="Field">proj₂</a><a id="plfa_plfa-part2-BigStep-1443" class="Symbol">)</a>
  <a id="plfa_plfa-part2-BigStep-1447" class="Keyword">renaming</a> <a id="plfa_plfa-part2-BigStep-1456" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1457" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="plfa_plfa-part2-BigStep-1461" class="Symbol">to</a> <a id="plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨_,_⟩</a><a id="plfa_plfa-part2-BigStep-1469" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-1471" class="Keyword">open</a> <a id="plfa_plfa-part2-BigStep-1476" class="Keyword">import</a> <a id="plfa_plfa-part2-BigStep-1483" href="https://agda.github.io/agda-stdlib/v2.1/Function.Base.html" class="Module">Function.Base</a> <a id="plfa_plfa-part2-BigStep-1497" class="Keyword">using</a> <a id="plfa_plfa-part2-BigStep-1503" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1504" href="https://agda.github.io/agda-stdlib/v2.1/Function.Base.html#1115" class="Function Operator">_∘_</a><a id="plfa_plfa-part2-BigStep-1507" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-1509" class="Keyword">open</a> <a id="plfa_plfa-part2-BigStep-1514" class="Keyword">import</a> <a id="plfa_plfa-part2-BigStep-1521" href="../Untyped/#" class="Module">plfa.part2.Untyped</a>
  <a id="plfa_plfa-part2-BigStep-1542" class="Keyword">using</a> <a id="plfa_plfa-part2-BigStep-1548" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1549" href="../Untyped/#plfa_plfa-part2-Untyped-2750" class="Datatype">Context</a><a id="plfa_plfa-part2-BigStep-1556" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1558" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">_⊢_</a><a id="plfa_plfa-part2-BigStep-1561" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1563" href="../Untyped/#plfa_plfa-part2-Untyped-3126" class="Datatype Operator">_∋_</a><a id="plfa_plfa-part2-BigStep-1566" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1568" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-1569" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1571" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a><a id="plfa_plfa-part2-BigStep-1572" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1574" href="../Untyped/#plfa_plfa-part2-Untyped-2788" class="InductiveConstructor Operator">_,_</a><a id="plfa_plfa-part2-BigStep-1577" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1579" href="../Untyped/#plfa_plfa-part2-Untyped-3162" class="InductiveConstructor">Z</a><a id="plfa_plfa-part2-BigStep-1580" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1582" href="../Untyped/#plfa_plfa-part2-Untyped-3207" class="InductiveConstructor Operator">S_</a><a id="plfa_plfa-part2-BigStep-1584" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1586" href="../Untyped/#plfa_plfa-part2-Untyped-3939" class="InductiveConstructor Operator">`_</a><a id="plfa_plfa-part2-BigStep-1588" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1590" href="../Untyped/#plfa_plfa-part2-Untyped-4782" class="Function Operator">#_</a><a id="plfa_plfa-part2-BigStep-1592" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1594" href="../Untyped/#plfa_plfa-part2-Untyped-3991" class="InductiveConstructor Operator">ƛ_</a><a id="plfa_plfa-part2-BigStep-1596" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1598" href="../Untyped/#plfa_plfa-part2-Untyped-4051" class="InductiveConstructor Operator">_·_</a><a id="plfa_plfa-part2-BigStep-1601" class="Symbol">;</a>
  <a id="plfa_plfa-part2-BigStep-1605" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a><a id="plfa_plfa-part2-BigStep-1610" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1612" href="../Untyped/#plfa_plfa-part2-Untyped-7175" class="Function">subst-zero</a><a id="plfa_plfa-part2-BigStep-1622" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1624" href="../Untyped/#plfa_plfa-part2-Untyped-6463" class="Function">exts</a><a id="plfa_plfa-part2-BigStep-1628" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1630" href="../Untyped/#plfa_plfa-part2-Untyped-6023" class="Function">rename</a><a id="plfa_plfa-part2-BigStep-1636" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1638" href="../Untyped/#plfa_plfa-part2-Untyped-10056" class="InductiveConstructor">β</a><a id="plfa_plfa-part2-BigStep-1639" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1641" href="../Untyped/#plfa_plfa-part2-Untyped-9876" class="InductiveConstructor">ξ₁</a><a id="plfa_plfa-part2-BigStep-1643" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1645" href="../Untyped/#plfa_plfa-part2-Untyped-9966" class="InductiveConstructor">ξ₂</a><a id="plfa_plfa-part2-BigStep-1647" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1649" href="../Untyped/#plfa_plfa-part2-Untyped-10164" class="InductiveConstructor">ζ</a><a id="plfa_plfa-part2-BigStep-1650" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1652" href="../Untyped/#plfa_plfa-part2-Untyped-9826" class="Datatype Operator">_—→_</a><a id="plfa_plfa-part2-BigStep-1656" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1658" href="../Untyped/#plfa_plfa-part2-Untyped-10958" class="Datatype Operator">_—↠_</a><a id="plfa_plfa-part2-BigStep-1662" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1664" href="../Untyped/#plfa_plfa-part2-Untyped-11146" class="InductiveConstructor Operator">_—→⟨_⟩_</a><a id="plfa_plfa-part2-BigStep-1671" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1673" href="../Untyped/#plfa_plfa-part2-Untyped-11004" class="InductiveConstructor Operator">_∎</a><a id="plfa_plfa-part2-BigStep-1675" class="Symbol">;</a>
  <a id="plfa_plfa-part2-BigStep-1679" href="../Untyped/#plfa_plfa-part2-Untyped-21705" class="Function">—↠-trans</a><a id="plfa_plfa-part2-BigStep-1687" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1689" href="../Untyped/#plfa_plfa-part2-Untyped-22879" class="Function">appL-cong</a><a id="plfa_plfa-part2-BigStep-1698" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-1700" class="Keyword">open</a> <a id="plfa_plfa-part2-BigStep-1705" class="Keyword">import</a> <a id="plfa_plfa-part2-BigStep-1712" href="../Substitution/#" class="Module">plfa.part2.Substitution</a> <a id="plfa_plfa-part2-BigStep-1736" class="Keyword">using</a> <a id="plfa_plfa-part2-BigStep-1742" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-1743" href="../Substitution/#plfa_plfa-part2-Substitution-2350" class="Function">Subst</a><a id="plfa_plfa-part2-BigStep-1748" class="Symbol">;</a> <a id="plfa_plfa-part2-BigStep-1750" href="../Substitution/#plfa_plfa-part2-Substitution-3005" class="Function">ids</a><a id="plfa_plfa-part2-BigStep-1753" class="Symbol">)</a>
</pre><h2 id="environments">Environments</h2><p>To handle variables and function applications, there is the choice between using substitution, as in <code>—→</code>, or to use an <em>environment</em>. An environment in call-by-name is a map from variables to closures, that is, to terms paired with their environments. We choose to use environments instead of substitution because the point of the call-by-name strategy is to be closer to an implementation of the language. Also, the denotational semantics introduced in later chapters uses environments and the proof of adequacy is made easier by aligning these choices.</p><p>We define environments and closures as follows.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-ClosEnv"></a><a id="plfa_plfa-part2-BigStep-2391" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2399" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2401" href="../Untyped/#plfa_plfa-part2-Untyped-2750" class="Datatype">Context</a> <a id="plfa_plfa-part2-BigStep-2409" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2411" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Primitive.html#388" class="Primitive">Set</a>

<a id="plfa_plfa-part2-BigStep-2416" class="Keyword">data</a> <a id="plfa_plfa-part2-BigStep-Clos"></a><a id="plfa_plfa-part2-BigStep-2421" href="../BigStep/#plfa_plfa-part2-BigStep-2421" class="Datatype">Clos</a> <a id="plfa_plfa-part2-BigStep-2426" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2428" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Primitive.html#388" class="Primitive">Set</a> <a id="plfa_plfa-part2-BigStep-2432" class="Keyword">where</a>
  <a id="plfa_plfa-part2-BigStep-Clos.clos"></a><a id="plfa_plfa-part2-BigStep-2440" href="../BigStep/#plfa_plfa-part2-BigStep-2440" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-2445" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2447" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-2449" href="../BigStep/#plfa_plfa-part2-BigStep-2449" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-2450" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-2452" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2454" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2455" href="../BigStep/#plfa_plfa-part2-BigStep-2455" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-2457" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2459" href="../BigStep/#plfa_plfa-part2-BigStep-2449" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2461" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-2463" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-2464" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-2466" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2468" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2476" href="../BigStep/#plfa_plfa-part2-BigStep-2449" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2478" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2480" href="../BigStep/#plfa_plfa-part2-BigStep-2421" class="Datatype">Clos</a>

<a id="plfa_plfa-part2-BigStep-2486" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2494" href="../BigStep/#plfa_plfa-part2-BigStep-2494" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2496" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-2498" class="Symbol">∀</a> <a id="plfa_plfa-part2-BigStep-2500" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2501" href="../BigStep/#plfa_plfa-part2-BigStep-2501" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-2503" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2505" href="../BigStep/#plfa_plfa-part2-BigStep-2494" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2507" href="../Untyped/#plfa_plfa-part2-Untyped-3126" class="Datatype Operator">∋</a> <a id="plfa_plfa-part2-BigStep-2509" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-2510" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-2512" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2514" href="../BigStep/#plfa_plfa-part2-BigStep-2421" class="Datatype">Clos</a>
</pre><p>As usual, we have the empty environment, and we can extend an environment.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-∅&#39;"></a><a id="plfa_plfa-part2-BigStep-2608" href="../BigStep/#plfa_plfa-part2-BigStep-2608" class="Function">∅&#39;</a> <a id="plfa_plfa-part2-BigStep-2611" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2613" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2621" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a>
<a id="plfa_plfa-part2-BigStep-2623" href="../BigStep/#plfa_plfa-part2-BigStep-2608" class="Function">∅&#39;</a> <a id="plfa_plfa-part2-BigStep-2626" class="Symbol">()</a>

<a id="plfa_plfa-part2-BigStep-_,&#39;_"></a><a id="plfa_plfa-part2-BigStep-2630" href="../BigStep/#plfa_plfa-part2-BigStep-2630" class="Function Operator">_,&#39;_</a> <a id="plfa_plfa-part2-BigStep-2635" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2637" class="Symbol">∀</a> <a id="plfa_plfa-part2-BigStep-2639" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-2640" href="../BigStep/#plfa_plfa-part2-BigStep-2640" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-2641" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-2643" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2645" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2653" href="../BigStep/#plfa_plfa-part2-BigStep-2640" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2655" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2657" href="../BigStep/#plfa_plfa-part2-BigStep-2421" class="Datatype">Clos</a> <a id="plfa_plfa-part2-BigStep-2662" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2664" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-2672" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2673" href="../BigStep/#plfa_plfa-part2-BigStep-2640" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-2675" href="../Untyped/#plfa_plfa-part2-Untyped-2788" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-2677" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-2678" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-2680" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2681" href="../BigStep/#plfa_plfa-part2-BigStep-2681" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-2683" href="../BigStep/#plfa_plfa-part2-BigStep-2630" class="Function Operator">,&#39;</a> <a id="plfa_plfa-part2-BigStep-2686" href="../BigStep/#plfa_plfa-part2-BigStep-2686" class="Bound">c</a><a id="plfa_plfa-part2-BigStep-2687" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-2689" href="../Untyped/#plfa_plfa-part2-Untyped-3162" class="InductiveConstructor">Z</a> <a id="plfa_plfa-part2-BigStep-2691" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-2693" href="../BigStep/#plfa_plfa-part2-BigStep-2686" class="Bound">c</a>
<a id="plfa_plfa-part2-BigStep-2695" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2696" href="../BigStep/#plfa_plfa-part2-BigStep-2696" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-2698" href="../BigStep/#plfa_plfa-part2-BigStep-2630" class="Function Operator">,&#39;</a> <a id="plfa_plfa-part2-BigStep-2701" href="../BigStep/#plfa_plfa-part2-BigStep-2701" class="Bound">c</a><a id="plfa_plfa-part2-BigStep-2702" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-2704" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-2705" href="../Untyped/#plfa_plfa-part2-Untyped-3207" class="InductiveConstructor Operator">S</a> <a id="plfa_plfa-part2-BigStep-2707" href="../BigStep/#plfa_plfa-part2-BigStep-2707" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-2708" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-2710" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-2712" href="../BigStep/#plfa_plfa-part2-BigStep-2696" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-2714" href="../BigStep/#plfa_plfa-part2-BigStep-2707" class="Bound">x</a>
</pre><h2 id="big-step-evaluation">Big-step evaluation</h2><p>The big-step semantics is represented as a ternary relation, written <code>γ ⊢ M ⇓ V</code>, where <code>γ</code> is the environment, <code>M</code> is the input term, and <code>V</code> is the result value. A <em>value</em> is a closure whose term is a lambda abstraction.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-2978" class="Keyword">data</a> <a id="plfa_plfa-part2-BigStep-_⊢_⇓_"></a><a id="plfa_plfa-part2-BigStep-2983" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">_⊢_⇓_</a> <a id="plfa_plfa-part2-BigStep-2989" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-2991" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-2993" href="../BigStep/#plfa_plfa-part2-BigStep-2993" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-2994" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-2996" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-2998" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3006" href="../BigStep/#plfa_plfa-part2-BigStep-2993" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-3008" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3010" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-3011" href="../BigStep/#plfa_plfa-part2-BigStep-2993" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-3013" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3015" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3016" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-3018" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3020" href="../BigStep/#plfa_plfa-part2-BigStep-2421" class="Datatype">Clos</a> <a id="plfa_plfa-part2-BigStep-3025" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3027" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Primitive.html#388" class="Primitive">Set</a> <a id="plfa_plfa-part2-BigStep-3031" class="Keyword">where</a>

  <a id="plfa_plfa-part2-BigStep-_⊢_⇓_.⇓-var"></a><a id="plfa_plfa-part2-BigStep-3040" href="../BigStep/#plfa_plfa-part2-BigStep-3040" class="InductiveConstructor">⇓-var</a> <a id="plfa_plfa-part2-BigStep-3046" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3048" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-3050" href="../BigStep/#plfa_plfa-part2-BigStep-3050" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3051" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3053" href="../BigStep/#plfa_plfa-part2-BigStep-3053" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3055" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3057" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3065" href="../BigStep/#plfa_plfa-part2-BigStep-3050" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3066" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3068" href="../BigStep/#plfa_plfa-part2-BigStep-3068" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-3070" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3072" href="../BigStep/#plfa_plfa-part2-BigStep-3050" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-3074" href="../Untyped/#plfa_plfa-part2-Untyped-3126" class="Datatype Operator">∋</a> <a id="plfa_plfa-part2-BigStep-3076" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3077" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3079" href="../BigStep/#plfa_plfa-part2-BigStep-3079" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-3080" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3082" href="../BigStep/#plfa_plfa-part2-BigStep-3082" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-3084" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3086" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3094" href="../BigStep/#plfa_plfa-part2-BigStep-3079" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-3095" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3097" href="../BigStep/#plfa_plfa-part2-BigStep-3097" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3099" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3101" href="../BigStep/#plfa_plfa-part2-BigStep-3079" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-3103" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3105" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3106" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3108" href="../BigStep/#plfa_plfa-part2-BigStep-3108" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-3109" class="Symbol">}</a>
    <a id="plfa_plfa-part2-BigStep-3115" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3117" href="../BigStep/#plfa_plfa-part2-BigStep-3053" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3119" href="../BigStep/#plfa_plfa-part2-BigStep-3068" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-3121" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-3123" href="../BigStep/#plfa_plfa-part2-BigStep-2440" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-3128" href="../BigStep/#plfa_plfa-part2-BigStep-3097" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3130" href="../BigStep/#plfa_plfa-part2-BigStep-3082" class="Bound">δ</a>
    <a id="plfa_plfa-part2-BigStep-3136" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3138" href="../BigStep/#plfa_plfa-part2-BigStep-3082" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-3140" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3142" href="../BigStep/#plfa_plfa-part2-BigStep-3097" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3144" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3146" href="../BigStep/#plfa_plfa-part2-BigStep-3108" class="Bound">V</a>
      <a id="plfa_plfa-part2-BigStep-3154" class="Comment">-----------</a>
    <a id="plfa_plfa-part2-BigStep-3170" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3172" href="../BigStep/#plfa_plfa-part2-BigStep-3053" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3174" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3176" href="../Untyped/#plfa_plfa-part2-Untyped-3939" class="InductiveConstructor Operator">`</a> <a id="plfa_plfa-part2-BigStep-3178" href="../BigStep/#plfa_plfa-part2-BigStep-3068" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-3180" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3182" href="../BigStep/#plfa_plfa-part2-BigStep-3108" class="Bound">V</a>

  <a id="plfa_plfa-part2-BigStep-_⊢_⇓_.⇓-lam"></a><a id="plfa_plfa-part2-BigStep-3187" href="../BigStep/#plfa_plfa-part2-BigStep-3187" class="InductiveConstructor">⇓-lam</a> <a id="plfa_plfa-part2-BigStep-3193" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3195" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-3197" href="../BigStep/#plfa_plfa-part2-BigStep-3197" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3198" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3200" href="../BigStep/#plfa_plfa-part2-BigStep-3200" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3202" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3204" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3212" href="../BigStep/#plfa_plfa-part2-BigStep-3197" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3213" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3215" href="../BigStep/#plfa_plfa-part2-BigStep-3215" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3217" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3219" href="../BigStep/#plfa_plfa-part2-BigStep-3197" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-3221" href="../Untyped/#plfa_plfa-part2-Untyped-2788" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-3223" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-3225" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3227" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3228" class="Symbol">}</a>
    <a id="plfa_plfa-part2-BigStep-3234" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3236" href="../BigStep/#plfa_plfa-part2-BigStep-3200" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3238" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3240" href="../Untyped/#plfa_plfa-part2-Untyped-3991" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-3242" href="../BigStep/#plfa_plfa-part2-BigStep-3215" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3244" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3246" href="../BigStep/#plfa_plfa-part2-BigStep-2440" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-3251" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-3252" href="../Untyped/#plfa_plfa-part2-Untyped-3991" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-3254" href="../BigStep/#plfa_plfa-part2-BigStep-3215" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-3255" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-3257" href="../BigStep/#plfa_plfa-part2-BigStep-3200" class="Bound">γ</a>

  <a id="plfa_plfa-part2-BigStep-_⊢_⇓_.⇓-app"></a><a id="plfa_plfa-part2-BigStep-3262" href="../BigStep/#plfa_plfa-part2-BigStep-3262" class="InductiveConstructor">⇓-app</a> <a id="plfa_plfa-part2-BigStep-3268" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3270" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-3272" href="../BigStep/#plfa_plfa-part2-BigStep-3272" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3273" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3275" href="../BigStep/#plfa_plfa-part2-BigStep-3275" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3277" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3279" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3287" href="../BigStep/#plfa_plfa-part2-BigStep-3272" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-3288" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3290" href="../BigStep/#plfa_plfa-part2-BigStep-3290" class="Bound">L</a> <a id="plfa_plfa-part2-BigStep-3292" href="../BigStep/#plfa_plfa-part2-BigStep-3292" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3294" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3296" href="../BigStep/#plfa_plfa-part2-BigStep-3272" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-3298" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3300" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3301" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3303" href="../BigStep/#plfa_plfa-part2-BigStep-3303" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-3304" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3306" href="../BigStep/#plfa_plfa-part2-BigStep-3306" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-3308" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3310" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-3318" href="../BigStep/#plfa_plfa-part2-BigStep-3303" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-3319" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3321" href="../BigStep/#plfa_plfa-part2-BigStep-3321" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-3323" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-3325" href="../BigStep/#plfa_plfa-part2-BigStep-3303" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-3327" href="../Untyped/#plfa_plfa-part2-Untyped-2788" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-3329" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-3331" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3333" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-3334" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-3336" href="../BigStep/#plfa_plfa-part2-BigStep-3336" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-3337" class="Symbol">}</a>
    <a id="plfa_plfa-part2-BigStep-3343" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3345" href="../BigStep/#plfa_plfa-part2-BigStep-3275" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3347" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3349" href="../BigStep/#plfa_plfa-part2-BigStep-3290" class="Bound">L</a> <a id="plfa_plfa-part2-BigStep-3351" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3353" href="../BigStep/#plfa_plfa-part2-BigStep-2440" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-3358" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-3359" href="../Untyped/#plfa_plfa-part2-Untyped-3991" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-3361" href="../BigStep/#plfa_plfa-part2-BigStep-3321" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-3362" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-3364" href="../BigStep/#plfa_plfa-part2-BigStep-3306" class="Bound">δ</a>   <a id="plfa_plfa-part2-BigStep-3368" class="Symbol">→</a>   <a id="plfa_plfa-part2-BigStep-3372" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-3373" href="../BigStep/#plfa_plfa-part2-BigStep-3306" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-3375" href="../BigStep/#plfa_plfa-part2-BigStep-2630" class="Function Operator">,&#39;</a> <a id="plfa_plfa-part2-BigStep-3378" href="../BigStep/#plfa_plfa-part2-BigStep-2440" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-3383" href="../BigStep/#plfa_plfa-part2-BigStep-3292" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3385" href="../BigStep/#plfa_plfa-part2-BigStep-3275" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-3386" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-3388" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3390" href="../BigStep/#plfa_plfa-part2-BigStep-3321" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-3392" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3394" href="../BigStep/#plfa_plfa-part2-BigStep-3336" class="Bound">V</a>
      <a id="plfa_plfa-part2-BigStep-3402" class="Comment">---------------------------------------------------</a>
    <a id="plfa_plfa-part2-BigStep-3458" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-3460" href="../BigStep/#plfa_plfa-part2-BigStep-3275" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-3462" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-3464" href="../BigStep/#plfa_plfa-part2-BigStep-3290" class="Bound">L</a> <a id="plfa_plfa-part2-BigStep-3466" href="../Untyped/#plfa_plfa-part2-Untyped-4051" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-BigStep-3468" href="../BigStep/#plfa_plfa-part2-BigStep-3292" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-3470" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-3472" href="../BigStep/#plfa_plfa-part2-BigStep-3336" class="Bound">V</a>
</pre><ul><li><p>The <code>⇓-var</code> rule evaluates a variable by finding the associated closure in the environment and then evaluating the closure.</p></li><li><p>The <code>⇓-lam</code> rule turns a lambda abstraction into a closure by packaging it up with its environment.</p></li><li><p>The <code>⇓-app</code> rule performs function application by first evaluating the term <code>L</code> in operator position. If that produces a closure containing a lambda abstraction <code>ƛ N</code>, then we evaluate the body <code>N</code> in an environment extended with the argument <code>M</code>. Note that <code>M</code> is not evaluated in rule <code>⇓-app</code> because this is call-by-name and not call-by-value.</p></li></ul><h4 id="exercise-big-step-eg-practice">Exercise <code>big-step-eg</code> (practice)</h4><p>Show that <code>(ƛ ƛ # 1) · ((ƛ # 0 · # 0) · (ƛ # 0 · # 0))</code> terminates under big-step call-by-name evaluation.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-4230" class="Comment">-- Your code goes here</a>
</pre><h2 id="the-big-step-semantics-is-deterministic">The big-step semantics is deterministic</h2><p>If the big-step relation evaluates a term <code>M</code> to both <code>V</code> and <code>V′</code>, then <code>V</code> and <code>V′</code> must be identical. In other words, the call-by-name relation is a partial function. The proof is a straightforward induction on the two big-step derivations.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-⇓-determ"></a><a id="plfa_plfa-part2-BigStep-4556" href="../BigStep/#plfa_plfa-part2-BigStep-4556" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4565" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-4567" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-4569" href="../BigStep/#plfa_plfa-part2-BigStep-4569" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-4570" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-4572" href="../BigStep/#plfa_plfa-part2-BigStep-4572" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-4574" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-4576" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-4584" href="../BigStep/#plfa_plfa-part2-BigStep-4569" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-4585" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-4587" href="../BigStep/#plfa_plfa-part2-BigStep-4587" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-4589" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-4591" href="../BigStep/#plfa_plfa-part2-BigStep-4569" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-4593" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-4595" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-4596" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-4598" href="../BigStep/#plfa_plfa-part2-BigStep-4598" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-4600" href="../BigStep/#plfa_plfa-part2-BigStep-4600" class="Bound">V&#39;</a> <a id="plfa_plfa-part2-BigStep-4603" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-4605" href="../BigStep/#plfa_plfa-part2-BigStep-2421" class="Datatype">Clos</a><a id="plfa_plfa-part2-BigStep-4609" class="Symbol">}</a>
  <a id="plfa_plfa-part2-BigStep-4613" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-4615" href="../BigStep/#plfa_plfa-part2-BigStep-4572" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-4617" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-4619" href="../BigStep/#plfa_plfa-part2-BigStep-4587" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-4621" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-4623" href="../BigStep/#plfa_plfa-part2-BigStep-4598" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-4625" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-4627" href="../BigStep/#plfa_plfa-part2-BigStep-4572" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-4629" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-4631" href="../BigStep/#plfa_plfa-part2-BigStep-4587" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-4633" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-4635" href="../BigStep/#plfa_plfa-part2-BigStep-4600" class="Bound">V&#39;</a>
  <a id="plfa_plfa-part2-BigStep-4640" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-4642" href="../BigStep/#plfa_plfa-part2-BigStep-4598" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-4644" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-4646" href="../BigStep/#plfa_plfa-part2-BigStep-4600" class="Bound">V&#39;</a>
<a id="plfa_plfa-part2-BigStep-4649" href="../BigStep/#plfa_plfa-part2-BigStep-4556" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4658" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-4659" href="../BigStep/#plfa_plfa-part2-BigStep-3040" class="InductiveConstructor">⇓-var</a> <a id="plfa_plfa-part2-BigStep-4665" href="../BigStep/#plfa_plfa-part2-BigStep-4665" class="Bound">eq1</a> <a id="plfa_plfa-part2-BigStep-4669" href="../BigStep/#plfa_plfa-part2-BigStep-4669" class="Bound">mc</a><a id="plfa_plfa-part2-BigStep-4671" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-4673" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-4674" href="../BigStep/#plfa_plfa-part2-BigStep-3040" class="InductiveConstructor">⇓-var</a> <a id="plfa_plfa-part2-BigStep-4680" href="../BigStep/#plfa_plfa-part2-BigStep-4680" class="Bound">eq2</a> <a id="plfa_plfa-part2-BigStep-4684" href="../BigStep/#plfa_plfa-part2-BigStep-4684" class="Bound">mc&#39;</a><a id="plfa_plfa-part2-BigStep-4687" class="Symbol">)</a>
    <a id="plfa_plfa-part2-BigStep-4693" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-4698" href="https://agda.github.io/agda-stdlib/v2.1/Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a> <a id="plfa_plfa-part2-BigStep-4704" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-4705" href="https://agda.github.io/agda-stdlib/v2.1/Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="plfa_plfa-part2-BigStep-4709" href="../BigStep/#plfa_plfa-part2-BigStep-4665" class="Bound">eq1</a><a id="plfa_plfa-part2-BigStep-4712" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-4714" href="../BigStep/#plfa_plfa-part2-BigStep-4680" class="Bound">eq2</a>
<a id="plfa_plfa-part2-BigStep-4718" class="Symbol">...</a> <a id="plfa_plfa-part2-BigStep-4722" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-4724" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="plfa_plfa-part2-BigStep-4729" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-4731" href="../BigStep/#plfa_plfa-part2-BigStep-4556" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4740" class="Bound">mc</a> <a id="plfa_plfa-part2-BigStep-4743" class="Bound">mc&#39;</a>
<a id="plfa_plfa-part2-BigStep-4747" href="../BigStep/#plfa_plfa-part2-BigStep-4556" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4756" href="../BigStep/#plfa_plfa-part2-BigStep-3187" class="InductiveConstructor">⇓-lam</a> <a id="plfa_plfa-part2-BigStep-4762" href="../BigStep/#plfa_plfa-part2-BigStep-3187" class="InductiveConstructor">⇓-lam</a> <a id="plfa_plfa-part2-BigStep-4768" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-4770" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="plfa_plfa-part2-BigStep-4775" href="../BigStep/#plfa_plfa-part2-BigStep-4556" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4784" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-4785" href="../BigStep/#plfa_plfa-part2-BigStep-3262" class="InductiveConstructor">⇓-app</a> <a id="plfa_plfa-part2-BigStep-4791" href="../BigStep/#plfa_plfa-part2-BigStep-4791" class="Bound">mc</a> <a id="plfa_plfa-part2-BigStep-4794" href="../BigStep/#plfa_plfa-part2-BigStep-4794" class="Bound">mc₁</a><a id="plfa_plfa-part2-BigStep-4797" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-4799" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-4800" href="../BigStep/#plfa_plfa-part2-BigStep-3262" class="InductiveConstructor">⇓-app</a> <a id="plfa_plfa-part2-BigStep-4806" href="../BigStep/#plfa_plfa-part2-BigStep-4806" class="Bound">mc&#39;</a> <a id="plfa_plfa-part2-BigStep-4810" href="../BigStep/#plfa_plfa-part2-BigStep-4810" class="Bound">mc&#39;&#39;</a><a id="plfa_plfa-part2-BigStep-4814" class="Symbol">)</a>
    <a id="plfa_plfa-part2-BigStep-4820" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-4825" href="../BigStep/#plfa_plfa-part2-BigStep-4556" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4834" href="../BigStep/#plfa_plfa-part2-BigStep-4791" class="Bound">mc</a> <a id="plfa_plfa-part2-BigStep-4837" href="../BigStep/#plfa_plfa-part2-BigStep-4806" class="Bound">mc&#39;</a>
<a id="plfa_plfa-part2-BigStep-4841" class="Symbol">...</a> <a id="plfa_plfa-part2-BigStep-4845" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-4847" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="plfa_plfa-part2-BigStep-4852" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-4854" href="../BigStep/#plfa_plfa-part2-BigStep-4556" class="Function">⇓-determ</a> <a id="plfa_plfa-part2-BigStep-4863" class="Bound">mc₁</a> <a id="plfa_plfa-part2-BigStep-4867" class="Bound">mc&#39;&#39;</a>
</pre><h2 id="big-step-evaluation-implies-beta-reduction-to-a-lambda">Big-step evaluation implies beta reduction to a lambda</h2><p>If big-step evaluation produces a value, then the input term can reduce to a lambda abstraction by beta reduction:</p><pre><code>  ∅&#39; ⊢ M ⇓ clos (ƛ N′) δ
  -----------------------------
→ Σ[ N ∈ ∅ , ★ ⊢ ★ ] (M —↠ ƛ N)</code></pre><p>The proof is by induction on the big-step derivation. As is often necessary, one must generalize the statement to get the induction to go through. In the case for <code>⇓-app</code> (function application), the argument is added to the environment, so the environment becomes non-empty. The corresponding β reduction substitutes the argument into the body of the lambda abstraction. So we generalize the lemma to allow an arbitrary environment <code>γ</code> and we add a premise that relates the environment <code>γ</code> to an equivalent substitution <code>σ</code>.</p><p>The case for <code>⇓-app</code> also requires that we strengthen the conclusion. In the case for <code>⇓-app</code> we have <code>γ ⊢ L ⇓ clos (λ N) δ</code> and the induction hypothesis gives us <code>L —↠ ƛ N′</code>, but we need to know that <code>N</code> and <code>N′</code> are equivalent. In particular, that <code>N′ ≡ subst τ N</code> where <code>τ</code> is the substitution that is equivalent to <code>δ</code>. Therefore we expand the conclusion of the statement, stating that the results are equivalent.</p><p>We make the two notions of equivalence precise by defining the following two mutually-recursive predicates <code>V ≈ M</code> and <code>γ ≈ₑ σ</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-_≈_"></a><a id="plfa_plfa-part2-BigStep-6239" href="../BigStep/#plfa_plfa-part2-BigStep-6239" class="Function Operator">_≈_</a> <a id="plfa_plfa-part2-BigStep-6243" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-6245" href="../BigStep/#plfa_plfa-part2-BigStep-2421" class="Datatype">Clos</a> <a id="plfa_plfa-part2-BigStep-6250" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6252" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-6253" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-6255" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-6257" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-6258" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-6260" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6262" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="plfa_plfa-part2-BigStep-_≈ₑ_"></a><a id="plfa_plfa-part2-BigStep-6266" href="../BigStep/#plfa_plfa-part2-BigStep-6266" class="Function Operator">_≈ₑ_</a> <a id="plfa_plfa-part2-BigStep-6271" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-6273" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-6275" href="../BigStep/#plfa_plfa-part2-BigStep-6275" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-6276" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-6278" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6280" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-6288" href="../BigStep/#plfa_plfa-part2-BigStep-6275" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-6290" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6292" href="../Substitution/#plfa_plfa-part2-Substitution-2350" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-6298" href="../BigStep/#plfa_plfa-part2-BigStep-6275" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-6300" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-6302" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6304" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Primitive.html#388" class="Primitive">Set</a>

<a id="plfa_plfa-part2-BigStep-6309" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-6310" href="../BigStep/#plfa_plfa-part2-BigStep-2440" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-6315" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-6316" href="../BigStep/#plfa_plfa-part2-BigStep-6316" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-6317" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-6319" href="../BigStep/#plfa_plfa-part2-BigStep-6319" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-6321" href="../BigStep/#plfa_plfa-part2-BigStep-6321" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-6322" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-6324" href="../BigStep/#plfa_plfa-part2-BigStep-6239" class="Function Operator">≈</a> <a id="plfa_plfa-part2-BigStep-6326" href="../BigStep/#plfa_plfa-part2-BigStep-6326" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-6328" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-6330" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="plfa_plfa-part2-BigStep-6333" href="../BigStep/#plfa_plfa-part2-BigStep-6333" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-6335" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1244" class="Function">∈</a> <a id="plfa_plfa-part2-BigStep-6337" href="../Substitution/#plfa_plfa-part2-Substitution-2350" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-6343" href="../BigStep/#plfa_plfa-part2-BigStep-6316" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-6345" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-6347" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1244" class="Function">]</a> <a id="plfa_plfa-part2-BigStep-6349" href="../BigStep/#plfa_plfa-part2-BigStep-6321" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-6351" href="../BigStep/#plfa_plfa-part2-BigStep-6266" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-6354" href="../BigStep/#plfa_plfa-part2-BigStep-6333" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-6356" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="plfa_plfa-part2-BigStep-6358" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-6359" href="../BigStep/#plfa_plfa-part2-BigStep-6326" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-6361" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-6363" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-6369" href="../BigStep/#plfa_plfa-part2-BigStep-6333" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-6371" href="../BigStep/#plfa_plfa-part2-BigStep-6319" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-6372" class="Symbol">)</a>

<a id="plfa_plfa-part2-BigStep-6375" href="../BigStep/#plfa_plfa-part2-BigStep-6375" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-6377" href="../BigStep/#plfa_plfa-part2-BigStep-6266" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-6380" href="../BigStep/#plfa_plfa-part2-BigStep-6380" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-6382" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-6384" class="Symbol">∀</a> <a id="plfa_plfa-part2-BigStep-6386" href="../BigStep/#plfa_plfa-part2-BigStep-6386" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-6388" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6390" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-6391" href="../BigStep/#plfa_plfa-part2-BigStep-6375" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-6393" href="../BigStep/#plfa_plfa-part2-BigStep-6386" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-6394" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-6396" href="../BigStep/#plfa_plfa-part2-BigStep-6239" class="Function Operator">≈</a> <a id="plfa_plfa-part2-BigStep-6398" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-6399" href="../BigStep/#plfa_plfa-part2-BigStep-6380" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-6401" href="../BigStep/#plfa_plfa-part2-BigStep-6386" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-6402" class="Symbol">)</a>
</pre><p>We can now state the main lemma:</p><pre><code>If γ ⊢ M ⇓ V  and  γ ≈ₑ σ,
then  subst σ M —↠ N  and  V ≈ N  for some N.</code></pre><p>Before starting the proof, we establish a couple lemmas about equivalent environments and substitutions.</p><p>The empty environment is equivalent to the identity substitution <code>ids</code>, which we import from Chapter <a href="../Substitution/">Substitution</a>.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-≈ₑ-id"></a><a id="plfa_plfa-part2-BigStep-6773" href="../BigStep/#plfa_plfa-part2-BigStep-6773" class="Function">≈ₑ-id</a> <a id="plfa_plfa-part2-BigStep-6779" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-6781" href="../BigStep/#plfa_plfa-part2-BigStep-2608" class="Function">∅&#39;</a> <a id="plfa_plfa-part2-BigStep-6784" href="../BigStep/#plfa_plfa-part2-BigStep-6266" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-6787" href="../Substitution/#plfa_plfa-part2-Substitution-3005" class="Function">ids</a>
<a id="plfa_plfa-part2-BigStep-6791" href="../BigStep/#plfa_plfa-part2-BigStep-6773" class="Function">≈ₑ-id</a> <a id="plfa_plfa-part2-BigStep-6797" class="Symbol">()</a>
</pre><p>Of course, applying the identity substitution to a term returns the same term.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-sub-id"></a><a id="plfa_plfa-part2-BigStep-6893" href="../BigStep/#plfa_plfa-part2-BigStep-6893" class="Function">sub-id</a> <a id="plfa_plfa-part2-BigStep-6900" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-6902" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-6904" href="../BigStep/#plfa_plfa-part2-BigStep-6904" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-6905" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-6907" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-6908" href="../BigStep/#plfa_plfa-part2-BigStep-6908" class="Bound">A</a><a id="plfa_plfa-part2-BigStep-6909" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-6911" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-6912" href="../BigStep/#plfa_plfa-part2-BigStep-6912" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-6914" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-6916" href="../BigStep/#plfa_plfa-part2-BigStep-6904" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-6918" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-6920" href="../BigStep/#plfa_plfa-part2-BigStep-6908" class="Bound">A</a><a id="plfa_plfa-part2-BigStep-6921" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-6923" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-6925" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-6931" href="../Substitution/#plfa_plfa-part2-Substitution-3005" class="Function">ids</a> <a id="plfa_plfa-part2-BigStep-6935" href="../BigStep/#plfa_plfa-part2-BigStep-6912" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-6937" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-6939" href="../BigStep/#plfa_plfa-part2-BigStep-6912" class="Bound">M</a>
<a id="plfa_plfa-part2-BigStep-6941" href="../BigStep/#plfa_plfa-part2-BigStep-6893" class="Function">sub-id</a> <a id="plfa_plfa-part2-BigStep-6948" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-6950" href="../Substitution/#plfa_plfa-part2-Substitution-16857" class="Function">plfa.part2.Substitution.sub-id</a>
</pre><p>We define an auxiliary function for extending a substitution.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-ext-subst"></a><a id="plfa_plfa-part2-BigStep-7058" href="../BigStep/#plfa_plfa-part2-BigStep-7058" class="Function">ext-subst</a> <a id="plfa_plfa-part2-BigStep-7068" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-7070" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-7072" href="../BigStep/#plfa_plfa-part2-BigStep-7072" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7074" href="../BigStep/#plfa_plfa-part2-BigStep-7074" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-7075" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-7077" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-7079" href="../Substitution/#plfa_plfa-part2-Substitution-2350" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-7085" href="../BigStep/#plfa_plfa-part2-BigStep-7072" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7087" href="../BigStep/#plfa_plfa-part2-BigStep-7074" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-7089" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-7091" href="../BigStep/#plfa_plfa-part2-BigStep-7074" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-7093" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-7095" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-7097" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-7099" href="../Substitution/#plfa_plfa-part2-Substitution-2350" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-7105" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7106" href="../BigStep/#plfa_plfa-part2-BigStep-7072" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7108" href="../Untyped/#plfa_plfa-part2-Untyped-2788" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-7110" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-7111" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-7113" href="../BigStep/#plfa_plfa-part2-BigStep-7074" class="Bound">Δ</a>
<a id="plfa_plfa-part2-BigStep-7115" href="../BigStep/#plfa_plfa-part2-BigStep-7058" class="Function">ext-subst</a><a id="plfa_plfa-part2-BigStep-7124" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-7125" href="../BigStep/#plfa_plfa-part2-BigStep-7125" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-7126" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7128" href="../BigStep/#plfa_plfa-part2-BigStep-7128" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-7129" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-7131" href="../BigStep/#plfa_plfa-part2-BigStep-7131" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-7133" href="../BigStep/#plfa_plfa-part2-BigStep-7133" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-7135" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-7136" href="../BigStep/#plfa_plfa-part2-BigStep-7136" class="Bound">A</a><a id="plfa_plfa-part2-BigStep-7137" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-7139" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-7141" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-7147" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7148" href="../Untyped/#plfa_plfa-part2-Untyped-7175" class="Function">subst-zero</a> <a id="plfa_plfa-part2-BigStep-7159" href="../BigStep/#plfa_plfa-part2-BigStep-7133" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-7160" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-7162" href="https://agda.github.io/agda-stdlib/v2.1/Function.Base.html#1115" class="Function Operator">∘</a> <a id="plfa_plfa-part2-BigStep-7164" href="../Untyped/#plfa_plfa-part2-Untyped-6463" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-7169" href="../BigStep/#plfa_plfa-part2-BigStep-7131" class="Bound">σ</a>
</pre><p>The next lemma we need to prove states that if you start with an equivalent environment and substitution <code>γ ≈ₑ σ</code>, extending them with an equivalent closure and term <code>V ≈ N</code> produces an equivalent environment and substitution: <code>(γ ,&#39; V) ≈ₑ (ext-subst σ N)</code>, or equivalently, <code>(γ ,&#39; V) x ≈ (ext-subst σ N) x</code> for any variable <code>x</code>. The proof will be by induction on <code>x</code> and for the induction step we need the following lemma, which states that applying the composition of <code>exts σ</code> and <code>subst-zero</code> to <code>S x</code> is the same as just <code>σ x</code>, which is a corollary of a theorem in Chapter <a href="../Substitution/">Substitution</a>.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-subst-zero-exts"></a><a id="plfa_plfa-part2-BigStep-7794" href="../BigStep/#plfa_plfa-part2-BigStep-7794" class="Function">subst-zero-exts</a> <a id="plfa_plfa-part2-BigStep-7810" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-7812" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-7814" href="../BigStep/#plfa_plfa-part2-BigStep-7814" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7816" href="../BigStep/#plfa_plfa-part2-BigStep-7816" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-7817" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7819" href="../BigStep/#plfa_plfa-part2-BigStep-7819" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-7821" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-7823" href="../Substitution/#plfa_plfa-part2-Substitution-2350" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-7829" href="../BigStep/#plfa_plfa-part2-BigStep-7814" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7831" href="../BigStep/#plfa_plfa-part2-BigStep-7816" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-7832" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7834" href="../BigStep/#plfa_plfa-part2-BigStep-7834" class="Bound">B</a><a id="plfa_plfa-part2-BigStep-7835" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7837" href="../BigStep/#plfa_plfa-part2-BigStep-7837" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-7839" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-7841" href="../BigStep/#plfa_plfa-part2-BigStep-7816" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-7843" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-7845" href="../BigStep/#plfa_plfa-part2-BigStep-7834" class="Bound">B</a><a id="plfa_plfa-part2-BigStep-7846" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7848" href="../BigStep/#plfa_plfa-part2-BigStep-7848" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-7850" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-7852" href="../BigStep/#plfa_plfa-part2-BigStep-7814" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-7854" href="../Untyped/#plfa_plfa-part2-Untyped-3126" class="Datatype Operator">∋</a> <a id="plfa_plfa-part2-BigStep-7856" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-7857" class="Symbol">}</a>
  <a id="plfa_plfa-part2-BigStep-7861" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-7863" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7864" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-7870" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7871" href="../Untyped/#plfa_plfa-part2-Untyped-7175" class="Function">subst-zero</a> <a id="plfa_plfa-part2-BigStep-7882" href="../BigStep/#plfa_plfa-part2-BigStep-7837" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-7883" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-7885" href="https://agda.github.io/agda-stdlib/v2.1/Function.Base.html#1115" class="Function Operator">∘</a> <a id="plfa_plfa-part2-BigStep-7887" href="../Untyped/#plfa_plfa-part2-Untyped-6463" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-7892" href="../BigStep/#plfa_plfa-part2-BigStep-7819" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-7893" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-7895" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7896" href="../Untyped/#plfa_plfa-part2-Untyped-3207" class="InductiveConstructor Operator">S</a> <a id="plfa_plfa-part2-BigStep-7898" href="../BigStep/#plfa_plfa-part2-BigStep-7848" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-7899" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-7901" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-7903" href="../BigStep/#plfa_plfa-part2-BigStep-7819" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-7905" href="../BigStep/#plfa_plfa-part2-BigStep-7848" class="Bound">x</a>
<a id="plfa_plfa-part2-BigStep-7907" href="../BigStep/#plfa_plfa-part2-BigStep-7794" class="Function">subst-zero-exts</a> <a id="plfa_plfa-part2-BigStep-7923" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-7924" href="../BigStep/#plfa_plfa-part2-BigStep-7924" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-7925" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7927" href="../BigStep/#plfa_plfa-part2-BigStep-7927" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-7928" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7930" href="../BigStep/#plfa_plfa-part2-BigStep-7930" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-7931" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7933" href="../BigStep/#plfa_plfa-part2-BigStep-7933" class="Bound">B</a><a id="plfa_plfa-part2-BigStep-7934" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7936" href="../BigStep/#plfa_plfa-part2-BigStep-7936" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-7937" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-7939" href="../BigStep/#plfa_plfa-part2-BigStep-7939" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-7940" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-7942" class="Symbol">=</a>
   <a id="plfa_plfa-part2-BigStep-7947" href="https://agda.github.io/agda-stdlib/v2.1/Relation.Binary.PropositionalEquality.Core.html#1670" class="Function">cong-app</a> <a id="plfa_plfa-part2-BigStep-7956" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-7957" href="../Substitution/#plfa_plfa-part2-Substitution-25086" class="Function">plfa.part2.Substitution.subst-zero-exts-cons</a><a id="plfa_plfa-part2-BigStep-8001" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8002" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-8004" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8006" href="../BigStep/#plfa_plfa-part2-BigStep-7930" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-8007" class="Symbol">})</a> <a id="plfa_plfa-part2-BigStep-8010" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8011" href="../Untyped/#plfa_plfa-part2-Untyped-3207" class="InductiveConstructor Operator">S</a> <a id="plfa_plfa-part2-BigStep-8013" href="../BigStep/#plfa_plfa-part2-BigStep-7939" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-8014" class="Symbol">)</a>
</pre><p>So the proof of <code>≈ₑ-ext</code> is as follows.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-≈ₑ-ext"></a><a id="plfa_plfa-part2-BigStep-8070" href="../BigStep/#plfa_plfa-part2-BigStep-8070" class="Function">≈ₑ-ext</a> <a id="plfa_plfa-part2-BigStep-8077" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8079" class="Symbol">∀</a> <a id="plfa_plfa-part2-BigStep-8081" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8082" href="../BigStep/#plfa_plfa-part2-BigStep-8082" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-8083" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8085" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8086" href="../BigStep/#plfa_plfa-part2-BigStep-8086" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-8088" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8090" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-8098" href="../BigStep/#plfa_plfa-part2-BigStep-8082" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-8099" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8101" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8102" href="../BigStep/#plfa_plfa-part2-BigStep-8102" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-8104" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8106" href="../Substitution/#plfa_plfa-part2-Substitution-2350" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-8112" href="../BigStep/#plfa_plfa-part2-BigStep-8082" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-8114" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a><a id="plfa_plfa-part2-BigStep-8115" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8117" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8118" href="../BigStep/#plfa_plfa-part2-BigStep-8118" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-8119" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8121" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8122" href="../BigStep/#plfa_plfa-part2-BigStep-8122" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-8124" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8126" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-8128" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-8130" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-8131" class="Symbol">}</a>
  <a id="plfa_plfa-part2-BigStep-8135" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-8137" href="../BigStep/#plfa_plfa-part2-BigStep-8086" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-8139" href="../BigStep/#plfa_plfa-part2-BigStep-6266" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-8142" href="../BigStep/#plfa_plfa-part2-BigStep-8102" class="Bound">σ</a>  <a id="plfa_plfa-part2-BigStep-8145" class="Symbol">→</a>  <a id="plfa_plfa-part2-BigStep-8148" href="../BigStep/#plfa_plfa-part2-BigStep-8118" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-8150" href="../BigStep/#plfa_plfa-part2-BigStep-6239" class="Function Operator">≈</a> <a id="plfa_plfa-part2-BigStep-8152" href="../BigStep/#plfa_plfa-part2-BigStep-8122" class="Bound">N</a>
    <a id="plfa_plfa-part2-BigStep-8158" class="Comment">--------------------------</a>
  <a id="plfa_plfa-part2-BigStep-8187" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-8189" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8190" href="../BigStep/#plfa_plfa-part2-BigStep-8086" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-8192" href="../BigStep/#plfa_plfa-part2-BigStep-2630" class="Function Operator">,&#39;</a> <a id="plfa_plfa-part2-BigStep-8195" href="../BigStep/#plfa_plfa-part2-BigStep-8118" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-8196" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-8198" href="../BigStep/#plfa_plfa-part2-BigStep-6266" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-8201" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8202" href="../BigStep/#plfa_plfa-part2-BigStep-7058" class="Function">ext-subst</a> <a id="plfa_plfa-part2-BigStep-8212" href="../BigStep/#plfa_plfa-part2-BigStep-8102" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-8214" href="../BigStep/#plfa_plfa-part2-BigStep-8122" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-8215" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-8217" href="../BigStep/#plfa_plfa-part2-BigStep-8070" class="Function">≈ₑ-ext</a> <a id="plfa_plfa-part2-BigStep-8224" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8225" href="../BigStep/#plfa_plfa-part2-BigStep-8225" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-8226" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8228" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8229" href="../BigStep/#plfa_plfa-part2-BigStep-8229" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-8230" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8232" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8233" href="../BigStep/#plfa_plfa-part2-BigStep-8233" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-8234" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8236" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8237" href="../BigStep/#plfa_plfa-part2-BigStep-8237" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-8238" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8240" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8241" href="../BigStep/#plfa_plfa-part2-BigStep-8241" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-8242" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8244" href="../BigStep/#plfa_plfa-part2-BigStep-8244" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-8249" href="../BigStep/#plfa_plfa-part2-BigStep-8249" class="Bound">V≈N</a> <a id="plfa_plfa-part2-BigStep-8253" href="../Untyped/#plfa_plfa-part2-Untyped-3162" class="InductiveConstructor">Z</a> <a id="plfa_plfa-part2-BigStep-8255" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8257" href="../BigStep/#plfa_plfa-part2-BigStep-8249" class="Bound">V≈N</a>
<a id="plfa_plfa-part2-BigStep-8261" href="../BigStep/#plfa_plfa-part2-BigStep-8070" class="Function">≈ₑ-ext</a> <a id="plfa_plfa-part2-BigStep-8268" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8269" href="../BigStep/#plfa_plfa-part2-BigStep-8269" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-8270" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8272" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8273" href="../BigStep/#plfa_plfa-part2-BigStep-8273" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-8274" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8276" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8277" href="../BigStep/#plfa_plfa-part2-BigStep-8277" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-8278" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8280" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8281" href="../BigStep/#plfa_plfa-part2-BigStep-8281" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-8282" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8284" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8285" href="../BigStep/#plfa_plfa-part2-BigStep-8285" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-8286" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8288" href="../BigStep/#plfa_plfa-part2-BigStep-8288" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-8293" href="../BigStep/#plfa_plfa-part2-BigStep-8293" class="Bound">V≈N</a> <a id="plfa_plfa-part2-BigStep-8297" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8298" href="../Untyped/#plfa_plfa-part2-Untyped-3207" class="InductiveConstructor Operator">S</a> <a id="plfa_plfa-part2-BigStep-8300" href="../BigStep/#plfa_plfa-part2-BigStep-8300" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-8301" class="Symbol">)</a>
  <a id="plfa_plfa-part2-BigStep-8305" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-BigStep-8313" href="../BigStep/#plfa_plfa-part2-BigStep-7794" class="Function">subst-zero-exts</a> <a id="plfa_plfa-part2-BigStep-8329" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8330" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-8332" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8334" href="../BigStep/#plfa_plfa-part2-BigStep-8277" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-8335" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-8337" class="Argument">M</a> <a id="plfa_plfa-part2-BigStep-8339" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8341" href="../BigStep/#plfa_plfa-part2-BigStep-8285" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-8342" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-8344" href="../BigStep/#plfa_plfa-part2-BigStep-8300" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-8345" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8347" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8349" href="../BigStep/#plfa_plfa-part2-BigStep-8288" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-8354" href="../BigStep/#plfa_plfa-part2-BigStep-8300" class="Bound">x</a>
</pre><p>We proceed by induction on the input variable.</p><ul><li><p>If it is <code>Z</code>, then we immediately conclude using the premise <code>V ≈ N</code>.</p></li><li><p>If it is <code>S x</code>, then we rewrite using the <code>subst-zero-exts</code> lemma and use the premise <code>γ ≈ₑ σ</code> to conclude.</p></li></ul><p>To prove the main lemma, we need another technical lemma about substitution. Applying one substitution after another is the same as composing the two substitutions and then applying them.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-sub-sub"></a><a id="plfa_plfa-part2-BigStep-8797" href="../BigStep/#plfa_plfa-part2-BigStep-8797" class="Function">sub-sub</a> <a id="plfa_plfa-part2-BigStep-8805" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8807" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-8809" href="../BigStep/#plfa_plfa-part2-BigStep-8809" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-8811" href="../BigStep/#plfa_plfa-part2-BigStep-8811" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-8813" href="../BigStep/#plfa_plfa-part2-BigStep-8813" class="Bound">Σ</a><a id="plfa_plfa-part2-BigStep-8814" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-8816" href="../BigStep/#plfa_plfa-part2-BigStep-8816" class="Bound">A</a><a id="plfa_plfa-part2-BigStep-8817" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-8819" href="../BigStep/#plfa_plfa-part2-BigStep-8819" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-8821" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8823" href="../BigStep/#plfa_plfa-part2-BigStep-8809" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-8825" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-8827" href="../BigStep/#plfa_plfa-part2-BigStep-8816" class="Bound">A</a><a id="plfa_plfa-part2-BigStep-8828" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8830" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8831" href="../BigStep/#plfa_plfa-part2-BigStep-8831" class="Bound">σ₁</a> <a id="plfa_plfa-part2-BigStep-8834" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8836" href="../Substitution/#plfa_plfa-part2-Substitution-2350" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-8842" href="../BigStep/#plfa_plfa-part2-BigStep-8809" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-8844" href="../BigStep/#plfa_plfa-part2-BigStep-8811" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-8845" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-8847" href="../BigStep/#plfa_plfa-part2-BigStep-8847" class="Bound">σ₂</a> <a id="plfa_plfa-part2-BigStep-8850" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-8852" href="../Substitution/#plfa_plfa-part2-Substitution-2350" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-8858" href="../BigStep/#plfa_plfa-part2-BigStep-8811" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-8860" href="../BigStep/#plfa_plfa-part2-BigStep-8813" class="Bound">Σ</a><a id="plfa_plfa-part2-BigStep-8861" class="Symbol">}</a>
  <a id="plfa_plfa-part2-BigStep-8865" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-8867" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-8873" href="../BigStep/#plfa_plfa-part2-BigStep-8847" class="Bound">σ₂</a> <a id="plfa_plfa-part2-BigStep-8876" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8877" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-8883" href="../BigStep/#plfa_plfa-part2-BigStep-8831" class="Bound">σ₁</a> <a id="plfa_plfa-part2-BigStep-8886" href="../BigStep/#plfa_plfa-part2-BigStep-8819" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-8887" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-8889" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="plfa_plfa-part2-BigStep-8891" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-8897" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-8898" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-8904" href="../BigStep/#plfa_plfa-part2-BigStep-8847" class="Bound">σ₂</a> <a id="plfa_plfa-part2-BigStep-8907" href="https://agda.github.io/agda-stdlib/v2.1/Function.Base.html#1115" class="Function Operator">∘</a> <a id="plfa_plfa-part2-BigStep-8909" href="../BigStep/#plfa_plfa-part2-BigStep-8831" class="Bound">σ₁</a><a id="plfa_plfa-part2-BigStep-8911" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-8913" href="../BigStep/#plfa_plfa-part2-BigStep-8819" class="Bound">M</a>
<a id="plfa_plfa-part2-BigStep-8915" href="../BigStep/#plfa_plfa-part2-BigStep-8797" class="Function">sub-sub</a> <a id="plfa_plfa-part2-BigStep-8923" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8924" class="Argument">M</a> <a id="plfa_plfa-part2-BigStep-8926" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8928" href="../BigStep/#plfa_plfa-part2-BigStep-8928" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-8929" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-8931" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8933" href="../Substitution/#plfa_plfa-part2-Substitution-22844" class="Function">plfa.part2.Substitution.sub-sub</a> <a id="plfa_plfa-part2-BigStep-8965" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-8966" class="Argument">M</a> <a id="plfa_plfa-part2-BigStep-8968" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-8970" href="../BigStep/#plfa_plfa-part2-BigStep-8928" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-8971" class="Symbol">}</a>
</pre><p>We arrive at the main lemma: if <code>M</code> big steps to a closure <code>V</code> in environment <code>γ</code>, and if <code>γ ≈ₑ σ</code>, then <code>subst σ M</code> reduces to some term <code>N</code> that is equivalent to <code>V</code>. We describe the proof below.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-⇓→—↠×≈"></a><a id="plfa_plfa-part2-BigStep-9185" href="../BigStep/#plfa_plfa-part2-BigStep-9185" class="Function">⇓→—↠×≈</a> <a id="plfa_plfa-part2-BigStep-9192" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-9194" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-9196" href="../BigStep/#plfa_plfa-part2-BigStep-9196" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-9197" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-9199" href="../BigStep/#plfa_plfa-part2-BigStep-9199" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-9201" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-9203" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-9211" href="../BigStep/#plfa_plfa-part2-BigStep-9196" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-9212" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-9214" href="../BigStep/#plfa_plfa-part2-BigStep-9214" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9216" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-9218" href="../Substitution/#plfa_plfa-part2-Substitution-2350" class="Function">Subst</a> <a id="plfa_plfa-part2-BigStep-9224" href="../BigStep/#plfa_plfa-part2-BigStep-9196" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-9226" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a><a id="plfa_plfa-part2-BigStep-9227" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-9229" href="../BigStep/#plfa_plfa-part2-BigStep-9229" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-9231" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-9233" href="../BigStep/#plfa_plfa-part2-BigStep-9196" class="Bound">Γ</a> <a id="plfa_plfa-part2-BigStep-9235" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-9237" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-9238" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-9240" href="../BigStep/#plfa_plfa-part2-BigStep-9240" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-9242" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-9244" href="../BigStep/#plfa_plfa-part2-BigStep-2421" class="Datatype">Clos</a><a id="plfa_plfa-part2-BigStep-9248" class="Symbol">}</a>
       <a id="plfa_plfa-part2-BigStep-9257" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-9259" href="../BigStep/#plfa_plfa-part2-BigStep-9199" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-9261" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-9263" href="../BigStep/#plfa_plfa-part2-BigStep-9229" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-9265" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-9267" href="../BigStep/#plfa_plfa-part2-BigStep-9240" class="Bound">V</a>  <a id="plfa_plfa-part2-BigStep-9270" class="Symbol">→</a>  <a id="plfa_plfa-part2-BigStep-9273" href="../BigStep/#plfa_plfa-part2-BigStep-9199" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-9275" href="../BigStep/#plfa_plfa-part2-BigStep-6266" class="Function Operator">≈ₑ</a> <a id="plfa_plfa-part2-BigStep-9278" href="../BigStep/#plfa_plfa-part2-BigStep-9214" class="Bound">σ</a>
         <a id="plfa_plfa-part2-BigStep-9289" class="Comment">---------------------------------------</a>
       <a id="plfa_plfa-part2-BigStep-9336" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-9338" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="plfa_plfa-part2-BigStep-9341" href="../BigStep/#plfa_plfa-part2-BigStep-9341" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-9343" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1244" class="Function">∈</a> <a id="plfa_plfa-part2-BigStep-9345" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-9347" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-9349" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-9351" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1244" class="Function">]</a> <a id="plfa_plfa-part2-BigStep-9353" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9354" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-9360" href="../BigStep/#plfa_plfa-part2-BigStep-9214" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9362" href="../BigStep/#plfa_plfa-part2-BigStep-9229" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-9364" href="../Untyped/#plfa_plfa-part2-Untyped-10958" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-BigStep-9367" href="../BigStep/#plfa_plfa-part2-BigStep-9341" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-9368" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9370" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="plfa_plfa-part2-BigStep-9372" href="../BigStep/#plfa_plfa-part2-BigStep-9240" class="Bound">V</a> <a id="plfa_plfa-part2-BigStep-9374" href="../BigStep/#plfa_plfa-part2-BigStep-6239" class="Function Operator">≈</a> <a id="plfa_plfa-part2-BigStep-9376" href="../BigStep/#plfa_plfa-part2-BigStep-9341" class="Bound">N</a>
<a id="plfa_plfa-part2-BigStep-9378" href="../BigStep/#plfa_plfa-part2-BigStep-9185" class="Function">⇓→—↠×≈</a> <a id="plfa_plfa-part2-BigStep-9385" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9386" class="Argument">γ</a> <a id="plfa_plfa-part2-BigStep-9388" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9390" href="../BigStep/#plfa_plfa-part2-BigStep-9390" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-9391" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9393" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9394" href="../BigStep/#plfa_plfa-part2-BigStep-3040" class="InductiveConstructor">⇓-var</a><a id="plfa_plfa-part2-BigStep-9399" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9400" class="Argument">x</a> <a id="plfa_plfa-part2-BigStep-9402" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9404" href="../BigStep/#plfa_plfa-part2-BigStep-9404" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-9405" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9407" href="../BigStep/#plfa_plfa-part2-BigStep-9407" class="Bound">γx≡Lδ</a> <a id="plfa_plfa-part2-BigStep-9413" href="../BigStep/#plfa_plfa-part2-BigStep-9413" class="Bound">δ⊢L⇓V</a><a id="plfa_plfa-part2-BigStep-9418" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9420" href="../BigStep/#plfa_plfa-part2-BigStep-9420" class="Bound">γ≈ₑσ</a>
    <a id="plfa_plfa-part2-BigStep-9429" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-9434" href="../BigStep/#plfa_plfa-part2-BigStep-9390" class="Bound">γ</a> <a id="plfa_plfa-part2-BigStep-9436" href="../BigStep/#plfa_plfa-part2-BigStep-9404" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-9438" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9440" href="../BigStep/#plfa_plfa-part2-BigStep-9420" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-9445" href="../BigStep/#plfa_plfa-part2-BigStep-9404" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-9447" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9449" href="../BigStep/#plfa_plfa-part2-BigStep-9407" class="Bound">γx≡Lδ</a>
<a id="plfa_plfa-part2-BigStep-9455" class="Symbol">...</a> <a id="plfa_plfa-part2-BigStep-9459" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9461" href="../BigStep/#plfa_plfa-part2-BigStep-2440" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-9466" href="../BigStep/#plfa_plfa-part2-BigStep-9466" class="Bound">L</a> <a id="plfa_plfa-part2-BigStep-9468" href="../BigStep/#plfa_plfa-part2-BigStep-9468" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-9470" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9472" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9474" href="../BigStep/#plfa_plfa-part2-BigStep-9474" class="Bound">τ</a> <a id="plfa_plfa-part2-BigStep-9476" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9478" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9480" href="../BigStep/#plfa_plfa-part2-BigStep-9480" class="Bound">δ≈ₑτ</a> <a id="plfa_plfa-part2-BigStep-9485" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9487" href="../BigStep/#plfa_plfa-part2-BigStep-9487" class="Bound">σx≡τL</a> <a id="plfa_plfa-part2-BigStep-9493" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9495" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9497" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9499" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
      <a id="plfa_plfa-part2-BigStep-9510" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-9515" href="../BigStep/#plfa_plfa-part2-BigStep-9185" class="Function">⇓→—↠×≈</a><a id="plfa_plfa-part2-BigStep-9521" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9522" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9524" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9526" href="../BigStep/#plfa_plfa-part2-BigStep-9474" class="Bound">τ</a><a id="plfa_plfa-part2-BigStep-9527" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9529" class="Bound">δ⊢L⇓V</a> <a id="plfa_plfa-part2-BigStep-9535" href="../BigStep/#plfa_plfa-part2-BigStep-9480" class="Bound">δ≈ₑτ</a>
<a id="plfa_plfa-part2-BigStep-9540" class="Symbol">...</a>   <a id="plfa_plfa-part2-BigStep-9546" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9548" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9550" href="../BigStep/#plfa_plfa-part2-BigStep-9550" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-9552" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9554" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9556" href="../BigStep/#plfa_plfa-part2-BigStep-9556" class="Bound">τL—↠N</a> <a id="plfa_plfa-part2-BigStep-9562" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9564" href="../BigStep/#plfa_plfa-part2-BigStep-9564" class="Bound">V≈N</a> <a id="plfa_plfa-part2-BigStep-9568" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9570" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9572" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-BigStep-9580" class="Bound">σx≡τL</a> <a id="plfa_plfa-part2-BigStep-9586" class="Symbol">=</a>
        <a id="plfa_plfa-part2-BigStep-9596" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9598" href="../BigStep/#plfa_plfa-part2-BigStep-9550" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-9600" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9602" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9604" href="../BigStep/#plfa_plfa-part2-BigStep-9556" class="Bound">τL—↠N</a> <a id="plfa_plfa-part2-BigStep-9610" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9612" href="../BigStep/#plfa_plfa-part2-BigStep-9564" class="Bound">V≈N</a> <a id="plfa_plfa-part2-BigStep-9616" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9618" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a>
<a id="plfa_plfa-part2-BigStep-9620" href="../BigStep/#plfa_plfa-part2-BigStep-9185" class="Function">⇓→—↠×≈</a> <a id="plfa_plfa-part2-BigStep-9627" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9628" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9630" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9632" href="../BigStep/#plfa_plfa-part2-BigStep-9632" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-9633" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9635" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9636" class="Argument">V</a> <a id="plfa_plfa-part2-BigStep-9638" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9640" href="../BigStep/#plfa_plfa-part2-BigStep-2440" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-9645" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9646" href="../Untyped/#plfa_plfa-part2-Untyped-3991" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-9648" href="../BigStep/#plfa_plfa-part2-BigStep-9648" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-9649" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9651" href="../BigStep/#plfa_plfa-part2-BigStep-9651" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-9652" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9654" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9655" href="../BigStep/#plfa_plfa-part2-BigStep-3187" class="InductiveConstructor">⇓-lam</a><a id="plfa_plfa-part2-BigStep-9660" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9662" href="../BigStep/#plfa_plfa-part2-BigStep-9662" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-9667" class="Symbol">=</a>
    <a id="plfa_plfa-part2-BigStep-9673" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9675" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-9681" href="../BigStep/#plfa_plfa-part2-BigStep-9632" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9683" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9684" href="../Untyped/#plfa_plfa-part2-Untyped-3991" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-9686" href="../BigStep/#plfa_plfa-part2-BigStep-9648" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-9687" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9689" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9691" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9693" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-9699" href="../BigStep/#plfa_plfa-part2-BigStep-9632" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9701" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9702" href="../Untyped/#plfa_plfa-part2-Untyped-3991" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-9704" href="../BigStep/#plfa_plfa-part2-BigStep-9648" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-9705" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9707" href="../Untyped/#plfa_plfa-part2-Untyped-11004" class="InductiveConstructor Operator">∎</a> <a id="plfa_plfa-part2-BigStep-9709" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9711" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9713" href="../BigStep/#plfa_plfa-part2-BigStep-9632" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9715" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9717" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9719" href="../BigStep/#plfa_plfa-part2-BigStep-9662" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-9724" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9726" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="plfa_plfa-part2-BigStep-9731" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9733" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9735" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9737" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a>
<a id="plfa_plfa-part2-BigStep-9739" href="../BigStep/#plfa_plfa-part2-BigStep-9185" class="Function">⇓→—↠×≈</a><a id="plfa_plfa-part2-BigStep-9745" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9746" href="../BigStep/#plfa_plfa-part2-BigStep-9746" class="Bound">Γ</a><a id="plfa_plfa-part2-BigStep-9747" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-9749" href="../BigStep/#plfa_plfa-part2-BigStep-9749" class="Bound">γ</a><a id="plfa_plfa-part2-BigStep-9750" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9752" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9753" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9755" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9757" href="../BigStep/#plfa_plfa-part2-BigStep-9757" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-9758" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9760" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9761" href="../BigStep/#plfa_plfa-part2-BigStep-9761" class="Bound">L</a> <a id="plfa_plfa-part2-BigStep-9763" href="../Untyped/#plfa_plfa-part2-Untyped-4051" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-BigStep-9765" href="../BigStep/#plfa_plfa-part2-BigStep-9765" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-9766" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9768" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9769" href="../BigStep/#plfa_plfa-part2-BigStep-9769" class="Bound">V</a><a id="plfa_plfa-part2-BigStep-9770" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9772" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9773" href="../BigStep/#plfa_plfa-part2-BigStep-3262" class="InductiveConstructor">⇓-app</a> <a id="plfa_plfa-part2-BigStep-9779" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9780" class="Argument">N</a> <a id="plfa_plfa-part2-BigStep-9782" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9784" href="../BigStep/#plfa_plfa-part2-BigStep-9784" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-9785" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9787" href="../BigStep/#plfa_plfa-part2-BigStep-9787" class="Bound">L⇓ƛNδ</a> <a id="plfa_plfa-part2-BigStep-9793" href="../BigStep/#plfa_plfa-part2-BigStep-9793" class="Bound">N⇓V</a><a id="plfa_plfa-part2-BigStep-9796" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-9798" href="../BigStep/#plfa_plfa-part2-BigStep-9798" class="Bound">γ≈ₑσ</a>
    <a id="plfa_plfa-part2-BigStep-9807" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-9812" href="../BigStep/#plfa_plfa-part2-BigStep-9185" class="Function">⇓→—↠×≈</a><a id="plfa_plfa-part2-BigStep-9818" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9819" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9821" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9823" href="../BigStep/#plfa_plfa-part2-BigStep-9757" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-9824" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9826" href="../BigStep/#plfa_plfa-part2-BigStep-9787" class="Bound">L⇓ƛNδ</a> <a id="plfa_plfa-part2-BigStep-9832" href="../BigStep/#plfa_plfa-part2-BigStep-9798" class="Bound">γ≈ₑσ</a>
<a id="plfa_plfa-part2-BigStep-9837" class="Symbol">...</a> <a id="plfa_plfa-part2-BigStep-9841" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-9843" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9845" class="Symbol">_</a> <a id="plfa_plfa-part2-BigStep-9847" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9849" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9851" href="../BigStep/#plfa_plfa-part2-BigStep-9851" class="Bound">σL—↠ƛτN</a> <a id="plfa_plfa-part2-BigStep-9859" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9861" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9863" href="../BigStep/#plfa_plfa-part2-BigStep-9863" class="Bound">τ</a> <a id="plfa_plfa-part2-BigStep-9865" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9867" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9869" href="../BigStep/#plfa_plfa-part2-BigStep-9869" class="Bound">δ≈ₑτ</a> <a id="plfa_plfa-part2-BigStep-9874" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9876" href="../BigStep/#plfa_plfa-part2-BigStep-9876" class="Bound">≡ƛτN</a> <a id="plfa_plfa-part2-BigStep-9881" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9883" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9885" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9887" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-9889" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-BigStep-9897" href="../BigStep/#plfa_plfa-part2-BigStep-9876" class="Bound">≡ƛτN</a>
      <a id="plfa_plfa-part2-BigStep-9908" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-9913" href="../BigStep/#plfa_plfa-part2-BigStep-9185" class="Function">⇓→—↠×≈</a> <a id="plfa_plfa-part2-BigStep-9920" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9921" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9923" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9925" href="../BigStep/#plfa_plfa-part2-BigStep-7058" class="Function">ext-subst</a> <a id="plfa_plfa-part2-BigStep-9935" href="../BigStep/#plfa_plfa-part2-BigStep-9863" class="Bound">τ</a> <a id="plfa_plfa-part2-BigStep-9937" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-9938" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-9944" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9946" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-9947" class="Symbol">)}</a> <a id="plfa_plfa-part2-BigStep-9950" class="Bound">N⇓V</a>
             <a id="plfa_plfa-part2-BigStep-9967" class="Symbol">(λ</a> <a id="plfa_plfa-part2-BigStep-9970" href="../BigStep/#plfa_plfa-part2-BigStep-9970" class="Bound">x</a> <a id="plfa_plfa-part2-BigStep-9972" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-9974" href="../BigStep/#plfa_plfa-part2-BigStep-8070" class="Function">≈ₑ-ext</a><a id="plfa_plfa-part2-BigStep-9980" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-9981" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-9983" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-9985" href="../BigStep/#plfa_plfa-part2-BigStep-9863" class="Bound">τ</a><a id="plfa_plfa-part2-BigStep-9986" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-9988" href="../BigStep/#plfa_plfa-part2-BigStep-9869" class="Bound">δ≈ₑτ</a> <a id="plfa_plfa-part2-BigStep-9993" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-9995" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-9997" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-9999" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-10001" class="Bound">γ≈ₑσ</a> <a id="plfa_plfa-part2-BigStep-10006" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-10008" href="https://agda.github.io/agda-stdlib/v2.1/Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="plfa_plfa-part2-BigStep-10013" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10015" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10017" href="../BigStep/#plfa_plfa-part2-BigStep-9970" class="Bound">x</a><a id="plfa_plfa-part2-BigStep-10018" class="Symbol">)</a>
           <a id="plfa_plfa-part2-BigStep-10031" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-10033" href="../Untyped/#plfa_plfa-part2-Untyped-10056" class="InductiveConstructor">β</a><a id="plfa_plfa-part2-BigStep-10034" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-10035" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a><a id="plfa_plfa-part2-BigStep-10036" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-10038" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-10044" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-10045" href="../Untyped/#plfa_plfa-part2-Untyped-6463" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-10050" href="../BigStep/#plfa_plfa-part2-BigStep-9863" class="Bound">τ</a><a id="plfa_plfa-part2-BigStep-10051" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-10053" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-10054" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-10056" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-10062" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-10064" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-10065" class="Symbol">}</a>
<a id="plfa_plfa-part2-BigStep-10067" class="Symbol">...</a>   <a id="plfa_plfa-part2-BigStep-10073" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-10075" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-10077" href="../BigStep/#plfa_plfa-part2-BigStep-10077" class="Bound">N&#39;</a> <a id="plfa_plfa-part2-BigStep-10080" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-10082" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-10084" href="../BigStep/#plfa_plfa-part2-BigStep-10084" class="Bound">—↠N&#39;</a> <a id="plfa_plfa-part2-BigStep-10089" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-10091" href="../BigStep/#plfa_plfa-part2-BigStep-10091" class="Bound">V≈N&#39;</a> <a id="plfa_plfa-part2-BigStep-10096" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10098" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10100" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-10102" href="../BigStep/#plfa_plfa-part2-BigStep-10102" class="Bound">ƛτN·σM—→</a>
        <a id="plfa_plfa-part2-BigStep-10119" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-BigStep-10127" href="../BigStep/#plfa_plfa-part2-BigStep-8797" class="Function">sub-sub</a><a id="plfa_plfa-part2-BigStep-10134" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-10135" class="Argument">M</a> <a id="plfa_plfa-part2-BigStep-10137" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-10139" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-10140" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-10142" class="Argument">σ₁</a> <a id="plfa_plfa-part2-BigStep-10145" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-10147" href="../Untyped/#plfa_plfa-part2-Untyped-6463" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-10152" class="Bound">τ</a><a id="plfa_plfa-part2-BigStep-10153" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-10155" class="Argument">σ₂</a> <a id="plfa_plfa-part2-BigStep-10158" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-10160" href="../Untyped/#plfa_plfa-part2-Untyped-7175" class="Function">subst-zero</a> <a id="plfa_plfa-part2-BigStep-10171" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-10172" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-10178" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-10180" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-10181" class="Symbol">)}</a> <a id="plfa_plfa-part2-BigStep-10184" class="Symbol">=</a>
        <a id="plfa_plfa-part2-BigStep-10194" class="Keyword">let</a> <a id="plfa_plfa-part2-BigStep-10198" href="../BigStep/#plfa_plfa-part2-BigStep-10198" class="Bound">rs</a> <a id="plfa_plfa-part2-BigStep-10201" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-10203" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-10204" href="../Untyped/#plfa_plfa-part2-Untyped-3991" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-10206" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-10212" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-10213" href="../Untyped/#plfa_plfa-part2-Untyped-6463" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-10218" class="Bound">τ</a><a id="plfa_plfa-part2-BigStep-10219" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-10221" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-10222" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-10224" href="../Untyped/#plfa_plfa-part2-Untyped-4051" class="InductiveConstructor Operator">·</a> <a id="plfa_plfa-part2-BigStep-10226" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-10232" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-10234" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-10236" href="../Untyped/#plfa_plfa-part2-Untyped-11146" class="InductiveConstructor Operator">—→⟨</a> <a id="plfa_plfa-part2-BigStep-10240" href="../BigStep/#plfa_plfa-part2-BigStep-10102" class="Bound">ƛτN·σM—→</a> <a id="plfa_plfa-part2-BigStep-10249" href="../Untyped/#plfa_plfa-part2-Untyped-11146" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10251" href="../BigStep/#plfa_plfa-part2-BigStep-10084" class="Bound">—↠N&#39;</a> <a id="plfa_plfa-part2-BigStep-10256" class="Keyword">in</a>
        <a id="plfa_plfa-part2-BigStep-10267" class="Keyword">let</a> <a id="plfa_plfa-part2-BigStep-10271" href="../BigStep/#plfa_plfa-part2-BigStep-10271" class="Bound">g</a> <a id="plfa_plfa-part2-BigStep-10273" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-10275" href="../Untyped/#plfa_plfa-part2-Untyped-21705" class="Function">—↠-trans</a> <a id="plfa_plfa-part2-BigStep-10284" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-10285" href="../Untyped/#plfa_plfa-part2-Untyped-22879" class="Function">appL-cong</a> <a id="plfa_plfa-part2-BigStep-10295" class="Bound">σL—↠ƛτN</a><a id="plfa_plfa-part2-BigStep-10302" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-10304" href="../BigStep/#plfa_plfa-part2-BigStep-10198" class="Bound">rs</a> <a id="plfa_plfa-part2-BigStep-10307" class="Keyword">in</a>
        <a id="plfa_plfa-part2-BigStep-10318" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-10320" href="../BigStep/#plfa_plfa-part2-BigStep-10077" class="Bound">N&#39;</a> <a id="plfa_plfa-part2-BigStep-10323" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-10325" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-10327" href="../BigStep/#plfa_plfa-part2-BigStep-10271" class="Bound">g</a> <a id="plfa_plfa-part2-BigStep-10329" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-10331" href="../BigStep/#plfa_plfa-part2-BigStep-10091" class="Bound">V≈N&#39;</a> <a id="plfa_plfa-part2-BigStep-10336" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-10338" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a>
</pre><p>The proof is by induction on <code>γ ⊢ M ⇓ V</code>. We have three cases to consider.</p><ul><li><p>Case <code>⇓-var</code>. So we have <code>γ x ≡ clos L δ</code> and <code>δ ⊢ L ⇓ V</code>. We need to show that <code>subst σ (` x) —↠ N</code> and <code>V ≈ N</code> for some <code>N</code>. The premise <code>γ ≈ₑ σ</code> tells us that <code>γ x ≈ σ x</code>, so <code>clos L δ ≈ σ x</code>. By the definition of <code>≈</code>, there exists a <code>τ</code> such that <code>δ ≈ₑ τ</code> and <code>σ x ≡ subst τ L</code>. Using <code>δ ⊢ L ⇓ V</code> and <code>δ ≈ₑ τ</code>, the induction hypothesis gives us <code>subst τ L —↠ N</code> and <code>V ≈ N</code> for some <code>N</code>. So we have shown that <code>subst σ x —↠ N</code> and <code>V ≈ N</code> for some <code>N</code>.</p></li><li><p>Case <code>⇓-lam</code>. We immediately have <code>subst σ (ƛ N) —↠ subst σ (ƛ N)</code> and <code>clos (subst σ (ƛ N)) γ ≈ subst σ (ƛ N)</code>.</p></li><li><p>Case <code>⇓-app</code>. Using <code>γ ⊢ L ⇓ clos (ƛ N) δ</code> and <code>γ ≈ₑ σ</code>, the induction hypothesis gives us</p><pre><code>  subst σ L —↠ ƛ subst (exts τ) N                                     (1)</code></pre><p>and <code>δ ≈ₑ τ</code> for some <code>τ</code>. From <code>γ≈ₑσ</code> we have <code>clos M γ ≈ subst σ M</code>. Then with <code>(δ ,&#39; clos M γ) ⊢ N ⇓ V</code>, the induction hypothesis gives us <code>V ≈ N&#39;</code> and</p><pre><code>  subst (subst (subst-zero (subst σ M)) ∘ (exts τ)) N —↠ N&#39;         (2)</code></pre><p>Meanwhile, by <code>β</code>, we have</p><pre><code>  (ƛ subst (exts τ) N) · subst σ M
  —→ subst (subst-zero (subst σ M)) (subst (exts τ) N)</code></pre><p>which is the same as the following, by <code>sub-sub</code>.</p><pre><code>  (ƛ subst (exts τ) N) · subst σ M
  —→ subst (subst (subst-zero (subst σ M)) ∘ exts τ) N              (3)</code></pre><p>Using (3) and (2) we have</p><pre><code>  (ƛ subst (exts τ) N) · subst σ M —↠ N&#39;                             (4)</code></pre><p>From (1) we have</p><pre><code>  subst σ L · subst σ M —↠ (ƛ subst (exts τ) N) · subst σ M</code></pre><p>which we combine with (4) to conclude that</p><pre><code>  subst σ L · subst σ M —↠ N&#39;</code></pre></li></ul><p>With the main lemma complete, we establish the forward direction of the equivalence between the big-step semantics and beta reduction.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-cbn→reduce"></a><a id="plfa_plfa-part2-BigStep-12174" href="../BigStep/#plfa_plfa-part2-BigStep-12174" class="Function">cbn→reduce</a> <a id="plfa_plfa-part2-BigStep-12185" class="Symbol">:</a>  <a id="plfa_plfa-part2-BigStep-12188" class="Symbol">∀{</a><a id="plfa_plfa-part2-BigStep-12190" href="../BigStep/#plfa_plfa-part2-BigStep-12190" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-12192" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-12194" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-12196" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-12198" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-12199" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12201" href="../BigStep/#plfa_plfa-part2-BigStep-12201" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-12202" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12204" href="../BigStep/#plfa_plfa-part2-BigStep-12204" class="Bound">δ</a> <a id="plfa_plfa-part2-BigStep-12206" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-12208" href="../BigStep/#plfa_plfa-part2-BigStep-2391" class="Function">ClosEnv</a> <a id="plfa_plfa-part2-BigStep-12216" href="../BigStep/#plfa_plfa-part2-BigStep-12201" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-12217" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12219" href="../BigStep/#plfa_plfa-part2-BigStep-12219" class="Bound">N′</a> <a id="plfa_plfa-part2-BigStep-12222" class="Symbol">:</a> <a id="plfa_plfa-part2-BigStep-12224" href="../BigStep/#plfa_plfa-part2-BigStep-12201" class="Bound">Δ</a> <a id="plfa_plfa-part2-BigStep-12226" href="../Untyped/#plfa_plfa-part2-Untyped-2788" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12228" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-12230" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-12232" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a><a id="plfa_plfa-part2-BigStep-12233" class="Symbol">}</a>
  <a id="plfa_plfa-part2-BigStep-12237" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-12239" href="../BigStep/#plfa_plfa-part2-BigStep-2608" class="Function">∅&#39;</a> <a id="plfa_plfa-part2-BigStep-12242" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-12244" href="../BigStep/#plfa_plfa-part2-BigStep-12190" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-12246" href="../BigStep/#plfa_plfa-part2-BigStep-2983" class="Datatype Operator">⇓</a> <a id="plfa_plfa-part2-BigStep-12248" href="../BigStep/#plfa_plfa-part2-BigStep-2440" class="InductiveConstructor">clos</a> <a id="plfa_plfa-part2-BigStep-12253" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-12254" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-12256" href="../BigStep/#plfa_plfa-part2-BigStep-12219" class="Bound">N′</a><a id="plfa_plfa-part2-BigStep-12258" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-12260" href="../BigStep/#plfa_plfa-part2-BigStep-12204" class="Bound">δ</a>
    <a id="plfa_plfa-part2-BigStep-12266" class="Comment">-----------------------------</a>
  <a id="plfa_plfa-part2-BigStep-12298" class="Symbol">→</a> <a id="plfa_plfa-part2-BigStep-12300" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="plfa_plfa-part2-BigStep-12303" href="../BigStep/#plfa_plfa-part2-BigStep-12303" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-12305" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1244" class="Function">∈</a> <a id="plfa_plfa-part2-BigStep-12307" href="../Untyped/#plfa_plfa-part2-Untyped-2772" class="InductiveConstructor">∅</a> <a id="plfa_plfa-part2-BigStep-12309" href="../Untyped/#plfa_plfa-part2-Untyped-2788" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12311" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-12313" href="../Untyped/#plfa_plfa-part2-Untyped-3903" class="Datatype Operator">⊢</a> <a id="plfa_plfa-part2-BigStep-12315" href="../Untyped/#plfa_plfa-part2-Untyped-2477" class="InductiveConstructor">★</a> <a id="plfa_plfa-part2-BigStep-12317" href="https://agda.github.io/agda-stdlib/v2.1/Data.Product.Base.html#1244" class="Function">]</a> <a id="plfa_plfa-part2-BigStep-12319" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-12320" href="../BigStep/#plfa_plfa-part2-BigStep-12190" class="Bound">M</a> <a id="plfa_plfa-part2-BigStep-12322" href="../Untyped/#plfa_plfa-part2-Untyped-10958" class="Datatype Operator">—↠</a> <a id="plfa_plfa-part2-BigStep-12325" class="InductiveConstructor Operator">ƛ</a> <a id="plfa_plfa-part2-BigStep-12327" href="../BigStep/#plfa_plfa-part2-BigStep-12303" class="Bound">N</a><a id="plfa_plfa-part2-BigStep-12328" class="Symbol">)</a>
<a id="plfa_plfa-part2-BigStep-12330" href="../BigStep/#plfa_plfa-part2-BigStep-12174" class="Function">cbn→reduce</a> <a id="plfa_plfa-part2-BigStep-12341" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-12342" href="../BigStep/#plfa_plfa-part2-BigStep-12342" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-12343" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12345" href="../BigStep/#plfa_plfa-part2-BigStep-12345" class="Bound">Δ</a><a id="plfa_plfa-part2-BigStep-12346" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12348" href="../BigStep/#plfa_plfa-part2-BigStep-12348" class="Bound">δ</a><a id="plfa_plfa-part2-BigStep-12349" class="Symbol">}{</a><a id="plfa_plfa-part2-BigStep-12351" href="../BigStep/#plfa_plfa-part2-BigStep-12351" class="Bound">N′</a><a id="plfa_plfa-part2-BigStep-12353" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-12355" href="../BigStep/#plfa_plfa-part2-BigStep-12355" class="Bound">M⇓c</a>
    <a id="plfa_plfa-part2-BigStep-12363" class="Keyword">with</a> <a id="plfa_plfa-part2-BigStep-12368" href="../BigStep/#plfa_plfa-part2-BigStep-9185" class="Function">⇓→—↠×≈</a><a id="plfa_plfa-part2-BigStep-12374" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-12375" class="Argument">σ</a> <a id="plfa_plfa-part2-BigStep-12377" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-12379" href="../Substitution/#plfa_plfa-part2-Substitution-3005" class="Function">ids</a><a id="plfa_plfa-part2-BigStep-12382" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-12384" href="../BigStep/#plfa_plfa-part2-BigStep-12355" class="Bound">M⇓c</a> <a id="plfa_plfa-part2-BigStep-12388" href="../BigStep/#plfa_plfa-part2-BigStep-6773" class="Function">≈ₑ-id</a>
<a id="plfa_plfa-part2-BigStep-12394" class="Symbol">...</a> <a id="plfa_plfa-part2-BigStep-12398" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-12400" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-12402" href="../BigStep/#plfa_plfa-part2-BigStep-12402" class="Bound">N</a> <a id="plfa_plfa-part2-BigStep-12404" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12406" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-12408" href="../BigStep/#plfa_plfa-part2-BigStep-12408" class="Bound">rs</a> <a id="plfa_plfa-part2-BigStep-12411" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12413" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-12415" href="../BigStep/#plfa_plfa-part2-BigStep-12415" class="Bound">σ</a> <a id="plfa_plfa-part2-BigStep-12417" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12419" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-12421" href="../BigStep/#plfa_plfa-part2-BigStep-12421" class="Bound">h</a> <a id="plfa_plfa-part2-BigStep-12423" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12425" href="../BigStep/#plfa_plfa-part2-BigStep-12425" class="Bound">eq2</a> <a id="plfa_plfa-part2-BigStep-12429" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-12431" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-12433" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-12435" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a> <a id="plfa_plfa-part2-BigStep-12437" class="Keyword">rewrite</a> <a id="plfa_plfa-part2-BigStep-12445" href="../BigStep/#plfa_plfa-part2-BigStep-6893" class="Function">sub-id</a><a id="plfa_plfa-part2-BigStep-12451" class="Symbol">{</a><a id="plfa_plfa-part2-BigStep-12452" class="Argument">M</a> <a id="plfa_plfa-part2-BigStep-12454" class="Symbol">=</a> <a id="plfa_plfa-part2-BigStep-12456" class="Bound">M</a><a id="plfa_plfa-part2-BigStep-12457" class="Symbol">}</a> <a id="plfa_plfa-part2-BigStep-12459" class="Symbol">|</a> <a id="plfa_plfa-part2-BigStep-12461" href="../BigStep/#plfa_plfa-part2-BigStep-12425" class="Bound">eq2</a> <a id="plfa_plfa-part2-BigStep-12465" class="Symbol">=</a>
      <a id="plfa_plfa-part2-BigStep-12473" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟨</a> <a id="plfa_plfa-part2-BigStep-12475" href="../Untyped/#plfa_plfa-part2-Untyped-6759" class="Function">subst</a> <a id="plfa_plfa-part2-BigStep-12481" class="Symbol">(</a><a id="plfa_plfa-part2-BigStep-12482" href="../Untyped/#plfa_plfa-part2-Untyped-6463" class="Function">exts</a> <a id="plfa_plfa-part2-BigStep-12487" href="../BigStep/#plfa_plfa-part2-BigStep-12415" class="Bound">σ</a><a id="plfa_plfa-part2-BigStep-12488" class="Symbol">)</a> <a id="plfa_plfa-part2-BigStep-12490" class="Bound">N′</a> <a id="plfa_plfa-part2-BigStep-12493" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">,</a> <a id="plfa_plfa-part2-BigStep-12495" href="../BigStep/#plfa_plfa-part2-BigStep-12408" class="Bound">rs</a> <a id="plfa_plfa-part2-BigStep-12498" href="../BigStep/#plfa_plfa-part2-BigStep-1464" class="InductiveConstructor Operator">⟩</a>
</pre><h4 id="exercise-big-alt-implies-multi-practice">Exercise <code>big-alt-implies-multi</code> (practice)</h4><p>Formulate an alternative big-step semantics, of the form <code>M ↓ N</code>, for call-by-name that uses substitution instead of environments. That is, the analogue of the application rule <code>⇓-app</code> should perform substitution, as in <code>N [ M ]</code>, instead of extending the environment with <code>M</code>. Prove that <code>M ↓ N</code> implies <code>M —↠ N</code>.</p><pre class="Agda"><a id="plfa_plfa-part2-BigStep-12880" class="Comment">-- Your code goes here</a>
</pre><h2 id="beta-reduction-to-a-lambda-implies-big-step-evaluation">Beta reduction to a lambda implies big-step evaluation</h2><p>The proof of the backward direction, that beta reduction to a lambda implies that the call-by-name semantics produces a result, is more difficult to prove. The difficulty stems from reduction proceeding underneath lambda abstractions via the <code>ζ</code> rule. The call-by-name semantics does not reduce under lambda, so a straightforward proof by induction on the reduction sequence is impossible. In the article <em>Call-by-name, call-by-value, and the λ-calculus</em>, Plotkin proves the theorem in two steps, using two auxiliary reduction relations. The first step uses a classic technique called Curry-Feys standardisation. It relies on the notion of <em>standard reduction sequence</em>, which acts as a half-way point between full beta reduction and call-by-name by expanding call-by-name to also include reduction underneath lambda. Plotkin proves that <code>M</code> reduces to <code>L</code> if and only if <code>M</code> is related to <code>L</code> by a standard reduction sequence.</p><pre><code>Theorem 1 (Standardisation)
`M —↠ L` if and only if `M` goes to `L` via a standard reduction sequence.</code></pre><p>Plotkin then introduces <em>left reduction</em>, a small-step version of call-by-name and uses the above theorem to prove that beta reduction and left reduction are equivalent in the following sense.</p><pre><code>Corollary 1
`M —↠ ƛ N` if and only if `M` goes to `ƛ N′`, for some `N′`, by left reduction.</code></pre><p>The second step of the proof connects left reduction to call-by-name evaluation.</p><pre><code>Theorem 2
`M` left reduces to `ƛ N` if and only if `⊢ M ⇓ ƛ N`.</code></pre><p>(Plotkin’s call-by-name evaluator uses substitution instead of environments, which explains why the environment is omitted in <code>⊢ M ⇓ ƛ N</code> in the above theorem statement.)</p><p>Putting Corollary 1 and Theorem 2 together, Plotkin proves that call-by-name evaluation is equivalent to beta reduction.</p><pre><code>Corollary 2
`M —↠ ƛ N` if and only if `⊢ M ⇓ ƛ N′` for some `N′`.</code></pre><p>Plotkin also proves an analogous result for the λᵥ calculus, relating it to call-by-value evaluation. For a nice exposition of that proof, we recommend Chapter 5 of <em>Semantics Engineering with PLT Redex</em> by Felleisen, Findler, and Flatt.</p><p>Instead of proving the backwards direction via standardisation, as sketched above, we defer the proof until after we define a denotational semantics for the lambda calculus, at which point the proof of the backwards direction will fall out as a corollary to the soundness and adequacy of the denotational semantics.</p><h2 id="unicode">Unicode</h2><p>This chapter uses the following unicode:</p><pre><code>≈  U+2248  ALMOST EQUAL TO (\~~ or \approx)
ₑ  U+2091  LATIN SUBSCRIPT SMALL LETTER E (\_e)
⊢  U+22A2  RIGHT TACK (\|- or \vdash)
⇓  U+21DB  DOWNWARDS DOUBLE ARROW (\d= or \Downarrow)</code></pre></div><nav class="pager" aria-label="Chapter"><ul class="pagination"><li><a class="pagelink" href="../Confluence/">Prev</a></li><li class="separator">•</li><li><a class="pagelink" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/part2/BigStep.lagda.md">Source</a></li><li class="separator">•</li><li><a class="pagelink" href="../Denotational/">Next</a></li><li class="separator">•</li></ul></nav></article></div></main><footer class="site-footer h-card" aria-label="Site"><data class="u-url" href="../"></data><div class="wrapper"><h2 class="footer-heading">Programming Language Foundations in Agda</h2><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Philip Wadler</li><li><a class="u-email" href="mailto:wadler@inf.ed.ac.uk"><i class="far fa-envelope"></i>  wadler@inf.ed.ac.uk</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a rel="me" href="https://github.com/wadler" title="wadler"><i class="fab fa-github"></i>  wadler</a></li></ul></div><div class="footer-col footer-col-3"></div></div><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Wen Kokke</li><li><a class="u-email" href="mailto:me@wen.works"><i class="far fa-envelope"></i>  me@wen.works</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a rel="me" href="https://github.com/wenkokke" title="wenkokke"><i class="fab fa-github"></i>  wenkokke</a></li><li><a rel="me" href="https://twitter.com/wenkokke" title="wenkokke"><i class="fab fa-twitter"></i>  wenkokke</a></li></ul></div><div class="footer-col footer-col-3"></div></div><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li class="p-name">Jeremy G. Siek</li><li><a class="u-email" href="mailto:jsiek@indiana.edu"><i class="far fa-envelope"></i>  jsiek@indiana.edu</a></li></ul></div><div class="footer-col footer-col-2"><ul class="social-media-list"><li><a rel="me" href="https://github.com/jsiek" title="jsiek"><i class="fab fa-github"></i>  jsiek</a></li><li><a rel="me" href="https://twitter.com/jeremysiek" title="jeremysiek"><i class="fab fa-twitter"></i>  jeremysiek</a></li></ul></div><div class="footer-col footer-col-3"></div></div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a></div></footer></body></html>